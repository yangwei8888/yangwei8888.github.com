

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Rationales for the Swift standard library designs &mdash; Swift Programming Language documentation 0.1.9 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Swift Programming Language documentation 0.1.9 documentation" href="index.html"/>
        <link rel="next" title="Stored and Computed Variables" href="StoredAndComputedVariables.html"/>
        <link rel="prev" title="Swift Standard Library API Design Guide" href="StdlibAPIGuidelines.html"/>
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Swift Programming Language documentation
          

          
          </a>

          
            
            
              <div class="version">
                0.1.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">swift docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ABI.html">The Swift ABI</a></li>
<li class="toctree-l1"><a class="reference internal" href="ARCOptimization.html">ARC Optimization for Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControl.html">Access Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html">Scope and introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html#public"><cite>public</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html#internal"><cite>internal</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html#private"><cite>private</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html#leading-underscore-rule">Leading Underscore Rule</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arrays.html">The Swift Array Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="CallingConvention.html">The Swift Calling Convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="DebuggingTheCompiler.html">Debugging the Swift Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dependency Analysis.html">Dependency Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="DriverInternals.html">Driver Design &amp; Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="DriverParseableOutput.html">Parseable Driver Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorHandling.html">Error Handling in Swift 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorHandlingRationale.html">Error Handling Rationale and Proposal</a></li>
<li class="toctree-l1"><a class="reference internal" href="Failable Initializers.html">Failable initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Generics.html">Generics in Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="GitWorkflows.html">Git Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="GitWorkflows.html#svn-git-workflows">SVN -&gt; GIT Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="HighLevelSILOptimizations.html">High-Level Optimizations in SIL</a></li>
<li class="toctree-l1"><a class="reference internal" href="Import.html">IMPORT SYNTAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="Import.html#resolving-name-clashes">RESOLVING NAME CLASHES</a></li>
<li class="toctree-l1"><a class="reference internal" href="Import.html#future-extensions">FUTURE EXTENSIONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="IndexInvalidation.html">Index Invalidation Rules in the Swift Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#using-versioned-api">Using Versioned API</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#publishing-versioned-api">Publishing Versioned API</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#giving-up-flexibility">Giving Up Flexibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#optimization">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#resilience-domains">Resilience Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#protocol-conformances">Protocol Conformances</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#checking-binary-compatibility">Checking Binary Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#summary">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#glossary">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="Literals.html">Literals</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogicalObjects.html">Logical Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modules.html">High-Level Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modules.html#import"><code class="docutils literal"><span class="pre">import</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Modules.html#interoperability-with-objective-c-via-clang">Interoperability with Objective-C via Clang</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modules.html#glossary">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="MutationModel.html">Immutability and Read-Only Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="ObjectInitialization.html">Object Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html">Writing High-Performance Swift Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#enabling-optimizations">Enabling Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#whole-module-optimizations">Whole Module Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#reducing-dynamic-dispatch">Reducing Dynamic Dispatch</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#using-container-types-efficiently">Using Container Types Efficiently</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#unchecked-operations">Unchecked operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#generics">Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#the-cost-of-large-swift-values">The cost of large swift values</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#unsafe-code">Unsafe code</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#protocols">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#footnotes">Footnotes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pattern Matching.html">Pattern Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="SIL.html">Swift Intermediate Language (SIL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SequencesAndCollections.html">Sequences And Collections in Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="Serialization.html">Swift Binary Serialization Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="StdlibAPIGuidelines.html">Swift Standard Library API Design Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Rationales for the Swift standard library designs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#current-designs">Current designs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#some-nsstring-apis-are-mirrored-on-string">Some <code class="docutils literal"><span class="pre">NSString</span></code> APIs are mirrored on <code class="docutils literal"><span class="pre">String</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#size-t-is-unsigned-but-it-is-imported-as-int"><code class="docutils literal"><span class="pre">size_t</span></code> is unsigned, but it is imported as <code class="docutils literal"><span class="pre">Int</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#type-conversions">Type Conversions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#protocols-with-restricted-conformance-rules">Protocols with restricted conformance rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#high-order-functions-on-collections-return-arrays">High-order functions on collections return <code class="docutils literal"><span class="pre">Array</span></code>s</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-remove-method-family-on-collections">The <cite>remove*()</cite> method family on collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lazy-functions-that-operate-on-sequences-and-collections">Lazy functions that operate on sequences and collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-of-booleantype-in-library-apis">Use of <code class="docutils literal"><span class="pre">BooleanType</span></code> in library APIs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#possible-future-directions">Possible future directions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mixed-type-fixed-point-arithmetic">Mixed-type fixed-point arithmetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#swift-power-operator">Swift: Power operator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="StoredAndComputedVariables.html">Stored and Computed Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="StringDesign.html">Swift String Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="Testing.html">Testing Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="TextFormatting.html">Text Formatting in Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransparentAttr.html"><code class="docutils literal"><span class="pre">&#64;_transparent</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="TypeChecker.html">Type Checker Design and Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html">Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="weak.html">Weak References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Swift Programming Language documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Rationales for the Swift standard library designs</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="_sources/StdlibRationales.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rationales-for-the-swift-standard-library-designs">
<h1>Rationales for the Swift standard library designs<a class="headerlink" href="#rationales-for-the-swift-standard-library-designs" title="Permalink to this headline">¶</a></h1>
<p>This document collects rationales for the Swift standard library.  It is not
meant to document all possible designs that we considered, but might describe
some of those, when important to explain the design that was chosen.</p>
<div class="section" id="current-designs">
<h2>Current designs<a class="headerlink" href="#current-designs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="some-nsstring-apis-are-mirrored-on-string">
<h3>Some <code class="docutils literal"><span class="pre">NSString</span></code> APIs are mirrored on <code class="docutils literal"><span class="pre">String</span></code><a class="headerlink" href="#some-nsstring-apis-are-mirrored-on-string" title="Permalink to this headline">¶</a></h3>
<p>There was not enough time in Swift 1.0 to design a rich <code class="docutils literal"><span class="pre">String</span></code> API, so we
reimplemented most of <code class="docutils literal"><span class="pre">NSString</span></code> APIs on <code class="docutils literal"><span class="pre">String</span></code> for parity.  This brought
the exact <code class="docutils literal"><span class="pre">NSString</span></code> semantics of those APIs, for example, treatment of
Unicode or behavior in edge cases (for example, empty strings), which we might
want to reconsider.</p>
<p>Radars: <a class="reference external" href="rdar://problem/19705854">rdar://problem/19705854</a></p>
</div>
<div class="section" id="size-t-is-unsigned-but-it-is-imported-as-int">
<h3><code class="docutils literal"><span class="pre">size_t</span></code> is unsigned, but it is imported as <code class="docutils literal"><span class="pre">Int</span></code><a class="headerlink" href="#size-t-is-unsigned-but-it-is-imported-as-int" title="Permalink to this headline">¶</a></h3>
<p>Converging APIs to use <code class="docutils literal"><span class="pre">Int</span></code> as the default integer type allows users to
write fewer explicit type conversions.</p>
<p>Importing <code class="docutils literal"><span class="pre">size_t</span></code> as a signed <code class="docutils literal"><span class="pre">Int</span></code> type would not be a problem for 64-bit
platforms.  The only concern is about 32-bit platforms, and only about
operating on array-like data structures that span more than half of the address
space.  Even today, in 2015, there are enough 32-bit platforms that are still
interesting, and x32 ABIs for 64-bit CPUs are also important.  We agree that
32-bit platforms are important, but the usecase for an unsigned <code class="docutils literal"><span class="pre">size_t</span></code> on
32-bit platforms is pretty marginal, and for code that nevertheless needs to do
that there is always the option of doing a bitcast to <code class="docutils literal"><span class="pre">UInt</span></code> or using C.</p>
</div>
<div class="section" id="type-conversions">
<h3>Type Conversions<a class="headerlink" href="#type-conversions" title="Permalink to this headline">¶</a></h3>
<p>The canonical way to convert from an instance <cite>x</cite> of type <code class="docutils literal"><span class="pre">T</span></code> to
type <code class="docutils literal"><span class="pre">U</span></code> is <code class="docutils literal"><span class="pre">U(x)</span></code>, a precedent set by <code class="docutils literal"><span class="pre">Int(value:</span> <span class="pre">UInt32)</span></code>.
Conversions that can fail should use failable initializers,
e.g. <code class="docutils literal"><span class="pre">Int(text:</span> <span class="pre">String)</span></code>, yielding a <code class="docutils literal"><span class="pre">Int?</span></code>. When other forms provide
added convenience, they may be provided as well. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>String.Index(s.utf16.startIndex.successor(), within: s) // canonical
s.utf16.startIndex.successor().samePositionIn(s)        // alternate
</pre></div>
</div>
<p>Converting initializers generally take one parameter. A converting
initializer&#8217;s first parameter should not have an argument label unless
it indicates a lossy, non-typesafe, or non-standard conversion method,
e.g. <code class="docutils literal"><span class="pre">Int(bitPattern:</span> <span class="pre">someUInt)</span></code>.  When a converting initializer
requires a parameter for context, it should not come first, and
generally <em>should</em> use a keyword.  For example, <code class="docutils literal"><span class="pre">String(33,</span> <span class="pre">radix:</span>
<span class="pre">2)</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rationale:</th><td class="field-body">First, type conversions are typical trouble spots, and we
like the idea that people are explicit about the types to which
they&#8217;re converting.  Secondly, avoiding method or property syntax
provides a distinct context for code completion.  Rather than
appearing in completions offered after <code class="docutils literal"><span class="pre">.</span></code>, for example, the
available conversions could show up whenever the user hit the “tab”
key after an expression.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="protocols-with-restricted-conformance-rules">
<h3>Protocols with restricted conformance rules<a class="headerlink" href="#protocols-with-restricted-conformance-rules" title="Permalink to this headline">¶</a></h3>
<p>It is sometimes useful to define a public protocol that only a limited set of
types can adopt.  There is no language feature in Swift to disallow declaring
conformances in third-party code: as long as the requirements are implemented
and the protocol is accessible, the compiler allows the conformance.</p>
<p>The standard library adopts the following pattern: the protocol is declared as
a regular public type, but it includes at least one requirement named using the
underscore rule.  That underscored API becomes private to the users according
to the standard library convention, effectively preventing third-party code from
declaring a conformance.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre>public protocol CVarArgType {
  var _cVarArgEncoding: [Word] { get }
}

// Public API that uses CVaListPointer, so CVarArgType has to be public, too.
public func withVaList&lt;R&gt;(
  args: [CVarArgType],
  @noescape f: (CVaListPointer) -&gt; R
) -&gt; R
</pre></div>
</div>
</div>
<div class="section" id="high-order-functions-on-collections-return-arrays">
<h3>High-order functions on collections return <code class="docutils literal"><span class="pre">Array</span></code>s<a class="headerlink" href="#high-order-functions-on-collections-return-arrays" title="Permalink to this headline">¶</a></h3>
<p>We can&#8217;t make <code class="docutils literal"><span class="pre">map()</span></code>, <code class="docutils literal"><span class="pre">filter()</span></code>, etc. all return <code class="docutils literal"><span class="pre">Self</span></code>:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">map()</span></code> takes a function <code class="docutils literal"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">U</span></code> and therefore can&#8217;t return Self
literally.  The required language feature for making <code class="docutils literal"><span class="pre">map()</span></code> return
something like <code class="docutils literal"><span class="pre">Self</span></code> in generic code (higher-kinded types) doesn&#8217;t exist
in Swift.  You can&#8217;t write a method like <code class="docutils literal"><span class="pre">func</span> <span class="pre">map(f:</span> <span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">U)</span> <span class="pre">-&gt;</span> <span class="pre">Self&lt;U&gt;</span></code>
today.</p>
</li>
<li><p class="first">There are lots of sequences that don&#8217;t have an appropriate form for the
result.  What happens when you filter the only element out of a
<code class="docutils literal"><span class="pre">SequenceOfOne&lt;T&gt;</span></code>, which is defined to have exactly one element?</p>
</li>
<li><p class="first">A <code class="docutils literal"><span class="pre">map()</span></code> that returns <code class="docutils literal"><span class="pre">Self&lt;U&gt;</span></code> hews most closely to the signature
required by Functor (mathematical purity of signature), but if you make map
on <code class="docutils literal"><span class="pre">Set</span></code> or <code class="docutils literal"><span class="pre">Dictionary</span></code> return <code class="docutils literal"><span class="pre">Self</span></code>, it violates the semantic laws
required by Functor, so it&#8217;s a false purity.  We&#8217;d rather preserve the
semantics of functional <code class="docutils literal"><span class="pre">map()</span></code> than its signature.</p>
</li>
<li><p class="first">The behavior is surprising (and error-prone) in generic code:</p>
<div class="highlight-python"><div class="highlight"><pre>func countFlattenedElements&lt;
  S : SequenceType where S.Generator.Element == Set&lt;Double&gt;
&gt;(sequence: S) -&gt; Int {
  return sequence.map { $0.count }.reduce(0) { $0 + $1 }
}
</pre></div>
</div>
</li>
</ul>
<p>The function behaves as expected when given an <code class="docutils literal"><span class="pre">[Set&lt;Double&gt;]</span></code>, but the
results are wrong for <code class="docutils literal"><span class="pre">Set&lt;Set&lt;Double&gt;&gt;</span></code>.  The <code class="docutils literal"><span class="pre">sequence.map()</span></code> operation
would return a <code class="docutils literal"><span class="pre">Set&lt;Int&gt;</span></code>, and all non-unique counts would disappear.</p>
<ul class="simple">
<li>Even if we throw semantics under the bus, maintaining mathematical purity of
signature prevents us from providing useful variants of these algorithms that
are the same in spirit, like the <code class="docutils literal"><span class="pre">flatMap()</span></code> that selects the non-nil
elements of the result sequence.</li>
</ul>
</div>
<div class="section" id="the-remove-method-family-on-collections">
<h3>The <cite>remove*()</cite> method family on collections<a class="headerlink" href="#the-remove-method-family-on-collections" title="Permalink to this headline">¶</a></h3>
<p>Protocol extensions for <code class="docutils literal"><span class="pre">RangeReplaceableCollectionType</span></code> define
<code class="docutils literal"><span class="pre">removeFirst(n:</span> <span class="pre">Int)</span></code> and <code class="docutils literal"><span class="pre">removeLast(n:</span> <span class="pre">Int)</span></code>.  These functions remove
exactly <code class="docutils literal"><span class="pre">n</span></code> elements; they don&#8217;t clamp <code class="docutils literal"><span class="pre">n</span></code> to <code class="docutils literal"><span class="pre">count</span></code> or they could be
masking bugs.</p>
<p>Since the standard library tries to preserve information, it also defines
special overloads that return just one element, <code class="docutils literal"><span class="pre">removeFirst()</span> <span class="pre">-&gt;</span> <span class="pre">Element</span></code>
and <code class="docutils literal"><span class="pre">removeLast()</span> <span class="pre">-&gt;</span> <span class="pre">Element</span></code>, that return the removed element.  These
overloads have a precondition that the collection is not empty.  Another
possible design would be that they don&#8217;t have preconditions and return
<code class="docutils literal"><span class="pre">Element?</span></code>.  Doing so would make the overload set inconsistent: semantics of
different overloads would be significantly different.  It would be surprising
that <code class="docutils literal"><span class="pre">myData.removeFirst()</span></code> and <code class="docutils literal"><span class="pre">myData.removeFirst(1)</span></code> are not equivalent.</p>
</div>
<div class="section" id="lazy-functions-that-operate-on-sequences-and-collections">
<h3>Lazy functions that operate on sequences and collections<a class="headerlink" href="#lazy-functions-that-operate-on-sequences-and-collections" title="Permalink to this headline">¶</a></h3>
<p>In many cases functions that operate on sequences can be implemented either
lazily or eagerly without compromising performance.  To decide between a lazy
and an eager implementation, the standard library uses the following rule.
When there is a choice, and not explicitly required by the API semantics,
functions don&#8217;t return lazy collection wrappers that refer to users&#8217; closures.
The consequence is that all users&#8217; closures are <code class="docutils literal"><span class="pre">&#64;noescape</span></code>, except in an
explicitly lazy context.</p>
<p>Based on this rule, we conclude that <code class="docutils literal"><span class="pre">enumerate(),</span> <span class="pre">``zip()</span></code> and
<code class="docutils literal"><span class="pre">reverse()</span></code> return lazy wrappers, but <code class="docutils literal"><span class="pre">filter()</span></code> and <code class="docutils literal"><span class="pre">map()</span></code> don&#8217;t.  For
the first three functions being lazy is the right default, since usually the
result is immediately consumed by for-in, so we don&#8217;t want to allocate memory
for it.</p>
<p>A different design that was rejected is to preserve consistency with other
strict functions by making these methods strict, but then client code needs to
call an API with a different name, say <code class="docutils literal"><span class="pre">lazyEnumerate()</span></code> to opt into
laziness.  The problem is that the eager API, which would have a shorter and
less obscure name, would be less efficient for the common case.</p>
</div>
<div class="section" id="use-of-booleantype-in-library-apis">
<h3>Use of <code class="docutils literal"><span class="pre">BooleanType</span></code> in library APIs<a class="headerlink" href="#use-of-booleantype-in-library-apis" title="Permalink to this headline">¶</a></h3>
<p>Use <code class="docutils literal"><span class="pre">Bool</span></code> instead of a generic function over a <code class="docutils literal"><span class="pre">BooleanType</span></code>, unless there
are special circumstances (for example, <code class="docutils literal"><span class="pre">func</span> <span class="pre">&amp;&amp;</span></code> is designed to work on all
boolean values so that <code class="docutils literal"><span class="pre">&amp;&amp;</span></code> feels like a part of the language).</p>
<p><code class="docutils literal"><span class="pre">BooleanType</span></code> is a protocol to which only <code class="docutils literal"><span class="pre">Bool</span></code> and <code class="docutils literal"><span class="pre">ObjCBool</span></code> conform.
Users don&#8217;t usually interact <code class="docutils literal"><span class="pre">ObjCBool</span></code> instances, except when using certain
specific APIs (for example, APIs that operate on pointers to <code class="docutils literal"><span class="pre">BOOL</span></code>).  If
someone already has an <code class="docutils literal"><span class="pre">ObjCBool</span></code> instance for whatever strange reason, they
can just convert it to <code class="docutils literal"><span class="pre">Bool</span></code>.  We think this is the right tradeoff:
simplifying function signatures is more important than making a marginal
usecase a bit more convenient.</p>
</div>
</div>
<div class="section" id="possible-future-directions">
<h2>Possible future directions<a class="headerlink" href="#possible-future-directions" title="Permalink to this headline">¶</a></h2>
<p>This section describes some of the possible future designs that we have
discussed.  Some might get dismissed, others might become full proposals and
get implemented.</p>
<div class="section" id="mixed-type-fixed-point-arithmetic">
<h3>Mixed-type fixed-point arithmetic<a class="headerlink" href="#mixed-type-fixed-point-arithmetic" title="Permalink to this headline">¶</a></h3>
<p>Radars: <a class="reference external" href="rdar://problem/18812545">rdar://problem/18812545</a> <a class="reference external" href="rdar://problem/18812365">rdar://problem/18812365</a></p>
<p>Standard library only defines arithmetic operators for LHS and RHS that have
matching types.  It might be useful to allow users to mix types.</p>
<p>There are multiple approaches:</p>
<ul class="simple">
<li>AIR model,</li>
<li>overloads in the standard library for operations that are always safe and
can&#8217;t trap (e.g., comparisons),</li>
<li>overloads in the standard library for all operations.</li>
</ul>
<p>TODO: describe advantages</p>
<p>The arguments towards not doing any of these, at least in the short term:</p>
<ul class="simple">
<li>demand might be lower than we think: seems like users have converged towards
using <code class="docutils literal"><span class="pre">Int</span></code> as the default integer type.</li>
<li>mitigation: import good C APIs that use appropriate typedefs for
unsigned integers (<code class="docutils literal"><span class="pre">size_t</span></code> for example) as <code class="docutils literal"><span class="pre">Int</span></code>.</li>
</ul>
</div>
<div class="section" id="swift-power-operator">
<h3>Swift: Power operator<a class="headerlink" href="#swift-power-operator" title="Permalink to this headline">¶</a></h3>
<p>Radars: <a class="reference external" href="rdar://problem/17283778">rdar://problem/17283778</a></p>
<p>It would be very useful to have a power operator in Swift.  We want to make
code look as close as possible to the domain notation, the two-dimensional
formula in this case.  In the two-dimensional representation exponentiation is
represented by a change in formatting.  With <code class="docutils literal"><span class="pre">pow()</span></code>, once you see the comma,
you have to scan to the left and count parentheses to even understand that
there is a <code class="docutils literal"><span class="pre">pow()</span></code> there.</p>
<p>The biggest concern is that adding an operator has a high barrier.
Nevertheless, we agree <code class="docutils literal"><span class="pre">**</span></code> is the right way to spell it, if we were to have
it.  Also there was some agreement that if we did not put this operator in the
core library (so that you won&#8217;t get it by default), it would become much more
compelling.</p>
<p>We will revisit the discussion when we have submodules for the standard
library, in one form or the other.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="StoredAndComputedVariables.html" class="btn btn-neutral float-right" title="Stored and Computed Variables" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="StdlibAPIGuidelines.html" class="btn btn-neutral" title="Swift Standard Library API Design Guide" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright apple.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>