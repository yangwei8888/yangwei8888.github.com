

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Literals &mdash; Swift Programming Language documentation 0.1.9 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Swift Programming Language documentation 0.1.9 documentation" href="index.html"/>
        <link rel="next" title="Logical Objects" href="LogicalObjects.html"/>
        <link rel="prev" title="Introduction" href="LibraryEvolution.html"/>
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Swift Programming Language documentation
          

          
          </a>

          
            
            
              <div class="version">
                0.1.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">swift docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ABI.html">The Swift ABI</a></li>
<li class="toctree-l1"><a class="reference internal" href="ARCOptimization.html">ARC Optimization for Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControl.html">Access Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html">Scope and introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html#public"><cite>public</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html#internal"><cite>internal</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html#private"><cite>private</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="AccessControlInStdlib.html#leading-underscore-rule">Leading Underscore Rule</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arrays.html">The Swift Array Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="CallingConvention.html">The Swift Calling Convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="DebuggingTheCompiler.html">Debugging the Swift Compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dependency Analysis.html">Dependency Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="DriverInternals.html">Driver Design &amp; Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="DriverParseableOutput.html">Parseable Driver Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorHandling.html">Error Handling in Swift 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorHandlingRationale.html">Error Handling Rationale and Proposal</a></li>
<li class="toctree-l1"><a class="reference internal" href="Failable Initializers.html">Failable initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Generics.html">Generics in Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="GitWorkflows.html">Git Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="GitWorkflows.html#svn-git-workflows">SVN -&gt; GIT Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="HighLevelSILOptimizations.html">High-Level Optimizations in SIL</a></li>
<li class="toctree-l1"><a class="reference internal" href="Import.html">IMPORT SYNTAX</a></li>
<li class="toctree-l1"><a class="reference internal" href="Import.html#resolving-name-clashes">RESOLVING NAME CLASHES</a></li>
<li class="toctree-l1"><a class="reference internal" href="Import.html#future-extensions">FUTURE EXTENSIONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="IndexInvalidation.html">Index Invalidation Rules in the Swift Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#using-versioned-api">Using Versioned API</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#publishing-versioned-api">Publishing Versioned API</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#giving-up-flexibility">Giving Up Flexibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#optimization">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#resilience-domains">Resilience Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#protocol-conformances">Protocol Conformances</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#checking-binary-compatibility">Checking Binary Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#summary">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="LibraryEvolution.html#glossary">Glossary</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Literals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#high-level-view">High-Level View</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-stringliteralconvertible-protocol">The StringLiteralConvertible Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-builtinstringliteralconvertible-protocol">The _BuiltinStringLiteralConvertible Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-type-checker-s-algorithm">The Type-Checker&#8217;s Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#arrays-dictionaries-and-interpolation">Arrays, Dictionaries, and Interpolation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LogicalObjects.html">Logical Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modules.html">High-Level Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modules.html#import"><code class="docutils literal"><span class="pre">import</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="Modules.html#interoperability-with-objective-c-via-clang">Interoperability with Objective-C via Clang</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modules.html#glossary">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="MutationModel.html">Immutability and Read-Only Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="ObjectInitialization.html">Object Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html">Writing High-Performance Swift Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#enabling-optimizations">Enabling Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#whole-module-optimizations">Whole Module Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#reducing-dynamic-dispatch">Reducing Dynamic Dispatch</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#using-container-types-efficiently">Using Container Types Efficiently</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#unchecked-operations">Unchecked operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#generics">Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#the-cost-of-large-swift-values">The cost of large swift values</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#unsafe-code">Unsafe code</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#protocols">Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="OptimizationTips.html#footnotes">Footnotes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pattern Matching.html">Pattern Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="SIL.html">Swift Intermediate Language (SIL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SequencesAndCollections.html">Sequences And Collections in Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="Serialization.html">Swift Binary Serialization Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="StdlibAPIGuidelines.html">Swift Standard Library API Design Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="StdlibRationales.html">Rationales for the Swift standard library designs</a></li>
<li class="toctree-l1"><a class="reference internal" href="StoredAndComputedVariables.html">Stored and Computed Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="StringDesign.html">Swift String Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="Testing.html">Testing Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="TextFormatting.html">Text Formatting in Swift</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransparentAttr.html"><code class="docutils literal"><span class="pre">&#64;_transparent</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="TypeChecker.html">Type Checker Design and Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html">Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="weak.html">Weak References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Swift Programming Language documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Literals</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="_sources/Literals.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="literals">
<h1>Literals<a class="headerlink" href="#literals" title="Permalink to this headline">¶</a></h1>
<p><em>What happens when a literal expression is used?</em></p>
<p>The complicated case is for integer, floating-point, character, and string
literals, so let&#8217;s look at those.</p>
<div class="section" id="high-level-view">
<h2>High-Level View<a class="headerlink" href="#high-level-view" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="n">window</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s">&quot;Welcome to Xcode&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, we have a string literal and an enclosing context. If <code class="docutils literal"><span class="pre">window</span></code>
is an NSWindow, there will only be one possible method named <code class="docutils literal"><span class="pre">setTitle</span></code>,
which takes an NSString. Therefore, we want the string literal expression to
end up being an NSString.</p>
<p>Fortunately, NSString implements StringLiteralConvertible, so the type checker
will indeed be able to choose NSString as the type of the string literal. All
is well.</p>
<p>In the case of integers or floating-point literals, the value effectively has
infinite precision. Once the type has been chosen, the value is checked to see
if it is in range for that type.</p>
</div>
<div class="section" id="the-stringliteralconvertible-protocol">
<h2>The StringLiteralConvertible Protocol<a class="headerlink" href="#the-stringliteralconvertible-protocol" title="Permalink to this headline">¶</a></h2>
<p>Here is the StringLiteralConvertible protocol as defined in the standard
library&#8217;s CompilerProtocols.swift:</p>
<div class="highlight-python"><div class="highlight"><pre>// NOTE: the compiler has builtin knowledge of this protocol
// Conforming types can be initialized with arbitrary string literals.
public protocol StringLiteralConvertible
  : ExtendedGraphemeClusterLiteralConvertible {

  typealias StringLiteralType : _BuiltinStringLiteralConvertible
  // Create an instance initialized to `value`.
  init(stringLiteral value: StringLiteralType)
}
</pre></div>
</div>
<p>Curiously, the protocol is not defined in terms of primitive types, but in
terms of any StringLiteralType that the implementer chooses. In most cases,
this will be Swift&#8217;s own native String type, which means users can implement
their own StringLiteralConvertible types while still dealing with a high-level
interface.</p>
<p>(Why is this not hardcoded? A String <em>must</em> be a valid Unicode string, but
if the string literal contains escape sequences, an invalid series of code
points could be constructed...which may be what&#8217;s desired in some cases.)</p>
</div>
<div class="section" id="the-builtinstringliteralconvertible-protocol">
<h2>The _BuiltinStringLiteralConvertible Protocol<a class="headerlink" href="#the-builtinstringliteralconvertible-protocol" title="Permalink to this headline">¶</a></h2>
<p>CompilerProtocols.swift contains a second protocol:</p>
<div class="highlight-python"><div class="highlight"><pre>// NOTE: the compiler has builtin knowledge of this protocol
public protocol _BuiltinStringLiteralConvertible
  : _BuiltinExtendedGraphemeClusterLiteralConvertible {

  init(
      _builtinStringLiteral start: Builtin.RawPointer,
      byteSize: Builtin.Word,
      isASCII: Builtin.Int1)
}
</pre></div>
</div>
<p>The use of builtin types makes it clear that this is <em>only</em> for use in the
standard library. This is the actual primitive function that is used to
construct types from string literals: the compiler knows how to emit raw
data from the literal, and the arguments describe that raw data.</p>
<p>So, the general runtime behavior is now clear:</p>
<ol class="arabic simple">
<li>The compiler generates raw string data.</li>
<li>Some type conforming to _BuiltinStringLiteralConvertible is constructed from
the raw string data. This will be a standard library type.</li>
<li>Some type conforming to StringLiteralConvertible is constructed from the
object constructed in step 2. This may be a user-defined type. This is the
result.</li>
</ol>
</div>
<div class="section" id="the-type-checker-s-algorithm">
<h2>The Type-Checker&#8217;s Algorithm<a class="headerlink" href="#the-type-checker-s-algorithm" title="Permalink to this headline">¶</a></h2>
<p>In order to make this actually happen, the type-checker has to do some fancy
footwork. Remember, at this point all we have is a string literal and an
expected type; if the function were overloaded, we would have to try all the
types.</p>
<p>This algorithm can go forwards or backwards, since it&#8217;s actually defined in
terms of constraints, but it&#8217;s easiest to understand as a linear process.</p>
<ol class="arabic simple">
<li>Filter the types provided by the context to only include those that are
StringLiteralConvertible.</li>
<li>Using the associated StringLiteralType, find the appropriate
<code class="docutils literal"><span class="pre">_convertFromBuiltinStringLiteral</span></code>.</li>
<li>Using the type from step 1, find the appropriate
<code class="docutils literal"><span class="pre">convertFromStringLiteral</span></code>.</li>
<li>Build an expression tree with the appropriate calls.</li>
</ol>
<p>How about cases where there is no context?</p>
<div class="highlight-python"><div class="highlight"><pre>var str = &quot;abc&quot;
</pre></div>
</div>
<p>Here we have nothing to go on, so instead the type checker looks for a global
type named <code class="docutils literal"><span class="pre">StringLiteralType</span></code> in the current module-scope context, and uses
that type if it is actually a StringLiteralConvertible type. This both allows
different standard libraries to set different default literal types, and allows
a user to <em>override</em> the default type in their own source file.</p>
<p>The real story is even more complicated because of implicit conversions:
the type expected by <code class="docutils literal"><span class="pre">setTitle</span></code> might not actually be literal-convertible,
but something else that <em>is</em> literal-convertible can then implicitly convert
to the proper type. If this makes your head spin, don&#8217;t worry about it.</p>
</div>
<div class="section" id="arrays-dictionaries-and-interpolation">
<h2>Arrays, Dictionaries, and Interpolation<a class="headerlink" href="#arrays-dictionaries-and-interpolation" title="Permalink to this headline">¶</a></h2>
<p>Array and dictionary literals don&#8217;t have a Builtin*Convertible form. Instead,
they just always use a variadic list of elements (<code class="docutils literal"><span class="pre">T...</span></code>) in the array case
and (key, value) tuples in the dictionary case. A variadic list is always
exposed using the standard library&#8217;s Array type, so there is no separate step
to jump through.</p>
<p>The default array literal type is always Array, and the default dictionary
literal type is always Dictionary.</p>
<p>String interpolations are a bit different: they try to individually convert
each element of the interpolation to the type that adopts
StringInterpolationConvertible, then calls the variadic
<code class="docutils literal"><span class="pre">convertFromStringInterpolation</span></code> to put them all together. The default type
for an interpolated literal without context is also <code class="docutils literal"><span class="pre">StringLiteralType</span></code>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="LogicalObjects.html" class="btn btn-neutral float-right" title="Logical Objects" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="LibraryEvolution.html" class="btn btn-neutral" title="Introduction" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright apple.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>