<!doctype html>
<html class="theme-next use-motion ">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />








  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


    <meta name="description" content="terry yang's blog | java | scala | bi" />



  <meta name="keywords" content="Hexo,next" />



  <link rel="alternate" href="/atom.xml" title="yosita" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="terry yang&apos;s blog | java | scala | bi">
<meta property="og:type" content="website">
<meta property="og:title" content="yosita">
<meta property="og:url" content="http://yoursite.com/page/12/index.html">
<meta property="og:site_name" content="yosita">
<meta property="og:description" content="terry yang&apos;s blog | java | scala | bi">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="yosita">
<meta name="twitter:description" content="terry yang&apos;s blog | java | scala | bi">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'post'
  };
</script>

  <title> yosita </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  

  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?953e46480b0a75d01aaf6d872cc77099";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">yosita</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 
  <section id="posts" class="posts-expand">
    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/12/08/docker/examples/running_ssh_service/" itemprop="url">
                在Docker中运行SSH进程服务
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-12-08T07:56:29+08:00" content="2015-12-08">
            2015-12-08
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/docker/" itemprop="url" rel="index">
                  <span itemprop="name">docker</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/12/08/docker/examples/running_ssh_service/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/08/docker/examples/running_ssh_service/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="u5728Docker_u4E2D_u8FD0_u884CSSH_u8FDB_u7A0B_u670D_u52A1"><a href="#u5728Docker_u4E2D_u8FD0_u884CSSH_u8FDB_u7A0B_u670D_u52A1" class="headerlink" title="在Docker中运行SSH进程服务"></a>在Docker中运行SSH进程服务</h1><p>以下是用<code>Dockerfile</code>设置sshd服务容器，您可以使用连接并检查其他容器的卷,或者可以快速访问测试容器。</p>
<pre><code># sshd
#
# VERSION               0.0.1

FROM     ubuntu:12.04
MAINTAINER Thatcher R. Peskens &quot;thatcher@dotcloud.com&quot;

# make sure the package repository is up to date
RUN apt-get update

RUN apt-get install -y openssh-server
RUN mkdir /var/run/sshd
RUN echo &apos;root:screencast&apos; |chpasswd

EXPOSE 22
CMD    [&quot;/usr/sbin/sshd&quot;, &quot;-D&quot;]
</code></pre><p>使用如下命令构建镜像：</p>
<pre><code>$ sudo docker build --rm -t eg_sshd .
</code></pre><p>然后运行它，你可以使用<code>docker port</code>来找出容器端口22映射到主机的端口</p>
<pre><code>$ sudo docker run -d -P --name test_sshd eg_sshd
$ sudo docker port test_sshd 22
0.0.0.0:49154
</code></pre><p>现在你可以使用ssh登陆Docker进程的主机IP地址，端口是49154(IP地址可以使用ifconfig获取)：</p>
<pre><code>$ ssh root@192.168.1.2 -p 49154
# The password is ``screencast``.
$$
</code></pre><p>最后，清理停止的容器，并且删除容器，然后删除镜像。</p>
<pre><code>$ sudo docker stop test_sshd
$ sudo docker rm test_sshd
$ sudo docker rmi eg_sshd
</code></pre></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/12/08/docker/installation/debian/" itemprop="url">
                Debian支持 Docker
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-12-08T07:56:29+08:00" content="2015-12-08">
            2015-12-08
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/docker/" itemprop="url" rel="index">
                  <span itemprop="name">docker</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/12/08/docker/installation/debian/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/08/docker/installation/debian/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="Debian"><a href="#Debian" class="headerlink" title="Debian"></a>Debian</h1><p>以下版本的 Debian 支持 Docker：</p>
<ul>
<li><a href="/#debian-jessie-80-64-bit">Debian 8.0 Jessie (64-bit)</a></li>
<li><a href="/#debian-wheezystable-7x-64-bit">Debian 7.7 Wheezy (64-bit)</a></li>
</ul>
<p>##Debian Jessie 8.0 (64-bit)Debian</p>
<p>Debian 8 使用的是 3.14.0 的内核版本，可以从 Debian 的镜像源来安装 <code>docker.io</code> 包。</p>
<blockquote>
<p>提示：Debian 包含一个特别老的KDE3/GNOME2包叫 <code>docker</code> ,所以我们把这个包叫<code>docker.io</code>。</p>
</blockquote>
<p>###安装</p>
<p>安装最新版的 Debian 软件包（可能不是最新版本 Docker ）</p>
<pre><code>$ sudo apt-get update
$ sudo apt-get install docker.io
</code></pre><p>验证 Docker 是否正常工作 ：</p>
<pre><code>$ sudo docker run -i -t  Ubuntu  /bin/bash
</code></pre><p>该命令将下载 <code>Ubuntu</code> 镜像，并且在容器内运行 <code>bash</code>.</p>
<blockquote>
<p>注意：如果你打算启用内存和交换空间设置，请查看<a href="/./ubuntu.md">这里</a></p>
</blockquote>
<p>##Debian Wheezy/Stable 7.x (64-bit)</p>
<p>安装 Docker 需要内核在3.8版本以上，但是 Wheezy 的内核版本是 3.2（<a href="https://github.com/docker/docker/issues/407%20kernel%20versions" target="_blank" rel="external">bug #407</a>对 Docker 需要3.8版本内核进行了讨论。）</p>
<p>幸运的是，官方提供了 <code>wheezy-backports</code> ，它内核版本是3.16，可以支持 Docker。</p>
<p>###安装</p>
<ol>
<li><p>从 wheezy-backports 镜像源来安装内核</p>
<p> 在 <code>/etc/apt/sources.list</code> 文件下添加如下内容：</p>
<pre><code>deb http://http.debian.net/debian wheezy-backports main
</code></pre><p> 安装 <code>linux-image-amd64</code> 包  (注意使用 <code>-t wheezy-backports</code>)</p>
<pre><code>$ sudo apt-get update
$ sudo apt-get install -t wheezy-backports linux-image-amd64
</code></pre></li>
<li><p>从 get.docker.com 获取安装脚本并安装：</p>
<pre><code>curl -sSL https://get.docker.com/ | sh
</code></pre></li>
</ol>
<p>###使用非root</p>
<p>docker 进程通过监听一个 Unix Socket 来替代 TCP 端口。在默认情况下，docker 的 Unix Socket属于<code>root</code>用户，当然其他用户可以使用<code>sudo</code>方式来访问。因为这个原因， docker 进程就一直是<code>root</code>用户运行的。</p>
<p>如果你（或者说你安装Docker的时候）创建一个叫 <code>docker</code> 的用户组，并为用户组添加用户。这时候，当 Docker 进程启动的时候，<code>docker</code> 用户组对 Unix Socket 有了读/写权限。 你必须使用root用户来运行 docker 进程，但你可以用 <code>docker</code> 群组用户来使用 docker 客户端，你再使用 docker 命令的时候前边就不需要加 <code>sudo</code> 了。从Docker 0.9版本开始，你可以使用<code>-G</code>来指定用户组。</p>
<blockquote>
<p>警告：Docker 用户组（或者用 <code>-G</code> 指定的用户组）有等同于root用户的权限，有关系统安全影响的细节，请查看 <a href="/">Docker 进程表面攻击细节</a></p>
</blockquote>
<p>操作演示：</p>
<pre><code># Add the docker group if it doesn&apos;t already exist.
$ sudo groupadd docker

# Add the connected user &quot;${USER}&quot; to the docker group.
# Change the user name to match your preferred user.
# You may have to logout and log back in again for
# this to take effect.
$ sudo gpasswd -a ${USER} docker

# Restart the Docker daemon.
$ sudo service docker restart
##下一步
</code></pre><p>继续阅读<a href="/../userguide/README.md">用户指南</a>。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/12/08/docker/https/" itemprop="url">
                使用 HTTPS 保护 Docker Socket 进程
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-12-08T07:56:29+08:00" content="2015-12-08">
            2015-12-08
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/docker/" itemprop="url" rel="index">
                  <span itemprop="name">docker</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/12/08/docker/https/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/08/docker/https/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="u4F7F_u7528_HTTPS__u4FDD_u62A4_Docker_Socket__u8FDB_u7A0B"><a href="#u4F7F_u7528_HTTPS__u4FDD_u62A4_Docker_Socket__u8FDB_u7A0B" class="headerlink" title="使用 HTTPS 保护 Docker Socket 进程"></a>使用 HTTPS 保护 Docker Socket 进程</h1><p>默认情况下，Docker 使用的是无网络环境的 Unix Socket。它可以使用 HTTP Socket 进行通信。</p>
<p>如果你需要 Docker 使用安全的方式来进行网络通信，你可以使用 <code>tlsverify</code> 标识来启用 TLS，并使用 <code>tlscacert</code> 标识来指定 CA 证书。</p>
<blockquote>
<p>警告：使用 TLS 和管理 CA 证书是一个高级话题。在投入生成环境使用之前，你需要自行熟悉了解 OpenSSL，X509 和 TLS 。</p>
<p>警告：这些 TLS 指令只能生成在 Linux 上工作的证书，Mac OSX 附带的 OpenSSL 版本与 Docker 所需要使用的证书不兼容。</p>
</blockquote>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/12/06/ouvens.github.io/frontend-javascript/2015-12-06-es6-in-nodejs/" itemprop="url">
                Nodejs下的ES6兼容性与性能分析
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-12-06T00:00:00+08:00" content="2015-12-06">
            2015-12-06
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/frontend-javascript/" itemprop="url" rel="index">
                  <span itemprop="name">frontend-javascript</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/12/06/ouvens.github.io/frontend-javascript/2015-12-06-es6-in-nodejs/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/12/06/ouvens.github.io/frontend-javascript/2015-12-06-es6-in-nodejs/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>ES6标准发布后，前端人员也开发渐渐了解到了es6，但是由于兼容性的问题，仍然没有得到广泛的推广，不过业界也用了一些折中性的方案来解决兼容性和开发体系问题，但大家仍很疑惑，使用ES6会有哪些兼容性问题。</p>
<h4 id="u4E00_u3001Nodejs_u4E0BES6_u517C_u5BB9_u6027_u73B0_u72B6"><a href="#u4E00_u3001Nodejs_u4E0BES6_u517C_u5BB9_u6027_u73B0_u72B6" class="headerlink" title="一、Nodejs下ES6兼容性现状"></a>一、Nodejs下ES6兼容性现状</h4><p>&emsp;&emsp;之前写了es6通过Babel编译后的在浏览器端的兼容性问题<a href="http://ouvens.github.io/frontend-javascript/2015/10/16/es6-under-babel.html" target="_blank" rel="external">《Babel下的ES6兼容性和规范》</a>，随着范围的扩展，ES6在Nodejs上兼容性也有必要重新梳理下。<br>&emsp;&emsp;随着iojs的引入，新版的Nodejs开始原生支持部分ES6的特性，既然ES6在浏览器端使用需要使用babel等编译，在Nodejs总可以放心使用了吧。然而事实并非如此，为此在nodejs端，我也做了特性兼容性研究：</p>
<p><strong>ES6新特性在Nodejs下的兼容性列表</strong><br>这里罗列下nodejs支持的新特性，没列出的新特性均为不支持。</p>
<p><a href="https://iojs.org/en/es6.html" target="_blank" rel="external">https://iojs.org/en/es6.html</a><br><a href="https://kangax.github.io/compat-table/es6/" target="_blank" rel="external">https://kangax.github.io/compat-table/es6/</a></p>
<table>
<thead>
<tr>
<th>ES6特性</th>
<th>Nodejs兼容性</th>
</tr>
</thead>
<tbody>
<tr>
<td>let,const,块</td>
<td>strict模式支持</td>
</tr>
<tr>
<td>class类</td>
<td>strict模式支持</td>
</tr>
<tr>
<td>Map，Set 和 WeakMap，WeakSet</td>
<td>支持</td>
</tr>
<tr>
<td>generators</td>
<td>支持</td>
</tr>
<tr>
<td>进制转换</td>
<td>支持</td>
</tr>
<tr>
<td>对象字面量扩展</td>
<td>支持</td>
</tr>
<tr>
<td>promise</td>
<td>支持</td>
</tr>
<tr>
<td>String对象新API</td>
<td>支持</td>
</tr>
<tr>
<td>symbols</td>
<td>支持</td>
</tr>
<tr>
<td>字符串模板</td>
<td>支持</td>
</tr>
</tbody>
</table>
<p>可见，es6的新特性在Nodejs中比babel还要差，而新版的babel已经能够支持es6的90%新特性了~</p>
<h4 id="u4E8C_u3001Nodejs_ES6_u6027_u80FD_u5206_u6790"><a href="#u4E8C_u3001Nodejs_ES6_u6027_u80FD_u5206_u6790" class="headerlink" title="二、Nodejs ES6性能分析"></a>二、Nodejs ES6性能分析</h4><p>&emsp;&emsp;尽管目前Node下使用ES6我们仍然会大失所望，但es6发展的趋势定是必然，这里还是有必要对ES6的原生性能做了详细的对比测试。测试基本方法：</p>
<p><strong>1，对于重复操作循环执行100万次</strong><br><strong>2，所有程序运行在Nodejs下执行</strong><br><strong>3，环境描述</strong></p>
<ul>
<li>CPU： Interl(R) Core(Tm) i5-3470 CPU @ 3.2GHz</li>
<li>内存：4.00GB</li>
<li>操作系统： 64位操作系统</li>
<li>node版本：node v5.1.1</li>
</ul>
<p><strong>2.1、let, const, 块</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi"></span><br><span class="line">'use strict'</span></span><br><span class="line"><span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> t1 = +<span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">    t2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i++ <span class="xml"><span class="tag">&lt; <span class="attribute">1000000</span>)&#123;</span><br><span class="line">    <span class="attribute">const</span> <span class="attribute">a</span> = <span class="attribute">1</span>;</span><br><span class="line">    <span class="attribute">const</span> <span class="attribute">b</span> = '<span class="attribute">1</span>';</span><br><span class="line">    <span class="attribute">const</span> <span class="attribute">c</span> = <span class="attribute">true</span>;</span><br><span class="line">    <span class="attribute">const</span> <span class="attribute">d</span> = &#123;&#125;;</span><br><span class="line">    <span class="attribute">const</span> <span class="attribute">e</span> = [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">t2</span> = +<span class="attribute">new</span> <span class="attribute">Date</span>() <span class="attribute">-</span> <span class="attribute">t1</span>;</span><br><span class="line"><span class="attribute">console.log</span>(<span class="attribute">t2</span>);</span></span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>运行次数</th>
<th>ES5运行时间</th>
<th>ES6运行时间</th>
</tr>
</thead>
<tbody>
<tr>
<td>100万</td>
<td>52-53ms</td>
<td>33-34ms</td>
</tr>
</tbody>
</table>
<p>结果让我震惊了，使用let，const声明变量的速度竟然比var快了约65%左右。原因可能是使用var会去检查作用域上的同名变量，而使用let或const不用考虑。</p>
<p><strong>2.2、class类使用</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi"></span><br><span class="line">'use strict'</span></span><br><span class="line"><span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> t1 = +<span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">    t2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i++ <span class="xml"><span class="tag">&lt; <span class="attribute">100000</span>)&#123;</span><br><span class="line">    <span class="attribute">class</span> <span class="attribute">A</span>&#123;</span><br><span class="line">        <span class="attribute">constructor</span>() &#123;</span><br><span class="line">           <span class="attribute">this.name</span> = '<span class="attribute">ouven</span>';</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attribute">getName</span>()&#123;</span><br><span class="line">            <span class="attribute">return</span> <span class="attribute">this.name</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">const</span> <span class="attribute">a</span> = <span class="attribute">new</span> <span class="attribute">A</span>();</span><br><span class="line">    <span class="attribute">a.getName</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">t2</span> = +<span class="attribute">new</span> <span class="attribute">Date</span>() <span class="attribute">-</span> <span class="attribute">t1</span>;</span><br><span class="line"><span class="attribute">console.log</span>(<span class="attribute">t2</span>);</span></span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>运行次数</th>
<th>ES5运行时间</th>
<th>ES6运行时间</th>
</tr>
</thead>
<tbody>
<tr>
<td>10万</td>
<td>1179-1211ms</td>
<td>1411-1442ms</td>
</tr>
</tbody>
</table>
<p>可见使用Nodejs的Class比ES的function构造方法慢约25%</p>
<p><strong>2.3、Map，Set 和 WeakMap，WeakSet</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi"></span><br><span class="line">'use strict'</span></span><br><span class="line"><span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> t1 = +<span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">    t2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i++ <span class="xml"><span class="tag">&lt; <span class="attribute">1000000</span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="attribute">let</span> <span class="attribute">map</span> = <span class="attribute">new</span> <span class="attribute">Map</span>();</span><br><span class="line">    <span class="attribute">map.set</span>('<span class="attribute">key</span>','<span class="attribute">value</span>');</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">t2</span> = +<span class="attribute">new</span> <span class="attribute">Date</span>() <span class="attribute">-</span> <span class="attribute">t1</span>;</span><br><span class="line"><span class="attribute">console.log</span>(<span class="attribute">t2</span>);</span></span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>运行次数</th>
<th>ES5运行时间</th>
<th>ES6运行时间</th>
</tr>
</thead>
<tbody>
<tr>
<td>100万</td>
<td>11-13ms</td>
<td>179-180ms</td>
</tr>
</tbody>
</table>
<p>测试结果看，Map的效率相对普通的对象key-value的结果相比慢的多，但是Map的Key可以使负责类型，这里的参考性也就不是绝对准确。建议是不到必须情况，不要使用Map等复杂类型。Set、WeakMap、WeakSet均相对object结构执行效率慢得多。</p>
<p><strong>2.4、字符串模板</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi"></span><br><span class="line">'use strict'</span></span><br><span class="line"><span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> t1 = +<span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">    t2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> vars = &#123;</span><br><span class="line">    name: <span class="string">'ouven'</span>,</span><br><span class="line">    address: <span class="string">'tencent'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i++ <span class="xml"><span class="tag">&lt; <span class="attribute">1000000</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">let</span> <span class="attribute">str</span> = `<span class="attribute">string</span> <span class="attribute">text</span> $&#123;<span class="attribute">vars.name</span>&#125; <span class="attribute">string</span> $&#123;<span class="attribute">vars.address</span>&#125;`;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">t2</span> = +<span class="attribute">new</span> <span class="attribute">Date</span>() <span class="attribute">-</span> <span class="attribute">t1</span>;</span><br><span class="line"><span class="attribute">console.log</span>(<span class="attribute">t2</span>);</span></span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>运行次数</th>
<th>ES5运行时间</th>
<th>ES6运行时间</th>
</tr>
</thead>
<tbody>
<tr>
<td>100万</td>
<td>8ms</td>
<td>59-61ms</td>
</tr>
</tbody>
</table>
<p>ES6的字符串模板看起来很好，但是由于执行时必须扫描这个串，找出里面的模板变量，所以整体上性能就相对ES5的字符串拼接慢了很多。</p>
<p>其它的特性实现有兴趣的同学可以自己继续研究。相信结果大概可以预测到。</p>
<p><a href="https://github.com/ouvens/demo-file/tree/master/es6-performance-test" target="_blank" rel="external">测试用例代码地址</a></p>
<h4 id="u4E09_u3001_u5C0F_u7ED3"><a href="#u4E09_u3001_u5C0F_u7ED3" class="headerlink" title="三、小结"></a>三、小结</h4><p>&emsp;&emsp;这里选择了ES6中的少数特性和ES5的实现的执行效率做了对比，整体上说，ES6的新特性相对ES5的实现效率慢些，而有些特性当然是ES5无法实现的。所以在了解使用ES6的同时，除了了解它的新特性和优点，对于ES6本身的一些问题也要做到心中有数。当然，随着ES6的完善和Node的更新，相信这些也不会是大的问题，而且这些也不会影响ES6的发展。</p>
<p>&emsp;&emsp;<a href="https://github.com/ouvens/ecmaScript-2015-babel-rules" target="_blank" rel="external">https://github.com/ouvens/ecmaScript-2015-babel-rules</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/11/29/ouvens.github.io/frontend-javascript/2015-11-29-js-data-two-ways-binding/" itemprop="url">
                javascript实现数据双向绑定的三种方式
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-11-29T00:00:00+08:00" content="2015-11-29">
            2015-11-29
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/frontend-javascript/" itemprop="url" rel="index">
                  <span itemprop="name">frontend-javascript</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/11/29/ouvens.github.io/frontend-javascript/2015-11-29-js-data-two-ways-binding/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/29/ouvens.github.io/frontend-javascript/2015-11-29-js-data-two-ways-binding/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h3 id="u524D_u7AEF_u6570_u636E_u7684_u53CC_u5411_u7ED1_u5B9A_u65B9_u6CD5"><a href="#u524D_u7AEF_u6570_u636E_u7684_u53CC_u5411_u7ED1_u5B9A_u65B9_u6CD5" class="headerlink" title="前端数据的双向绑定方法"></a>前端数据的双向绑定方法</h3><p>&emsp;&emsp;前端的视图层和数据层有时需要实现双向绑定(two-way-binding)，例如mvvm框架，数据驱动视图，视图状态机等，研究了几个目前主流的数据双向绑定框架，总结了下。目前实现数据双向绑定主要有以下三种。</p>
<p><a href="https://github.com/ouvens/demo-file/tree/master/two-ways-binding" target="_blank" rel="external">github演示例子</a></p>
<h4 id="1_u3001_u624B_u52A8_u7ED1_u5B9A"><a href="#1_u3001_u624B_u52A8_u7ED1_u5B9A" class="headerlink" title="1、手动绑定"></a>1、手动绑定</h4><p>比较老的实现方式，有点像观察者编程模式，主要思路是通过在数据对象上定义get和set方法(当然还有其它方法)，调用时手动调用get或set数据，改变数据后出发UI层的渲染操作；以视图驱动数据变化的场景主要应用与input、select、textarea等元素，当UI层变化时，通过监听dom的change，keypress，keyup等事件来出发事件改变数据层的数据。整个过程均通过函数调用完成。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>data-binding-method-set<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">q-value</span>=<span class="value">"value"</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">id</span>=<span class="value">"input"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">q-text</span>=<span class="value">"value"</span> <span class="attribute">id</span>=<span class="value">"el"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">        <span class="keyword">var</span> elems = [<span class="built_in">document</span>.getElementById(<span class="string">'el'</span>), <span class="built_in">document</span>.getElementById(<span class="string">'input'</span>)];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> data = &#123;</span><br><span class="line">            value: <span class="string">'hello!'</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> command = &#123;</span><br><span class="line">            text: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.innerHTML = str;</span><br><span class="line">            &#125;,</span><br><span class="line">            value: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.setAttribute(<span class="string">'value'</span>, str);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> scan = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;        </span><br><span class="line">            <span class="comment">/**</span><br><span class="line">             * 扫描带指令的节点属性</span><br><span class="line">             */</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, len = elems.length; i &lt; len; i++)&#123;</span><br><span class="line">                <span class="keyword">var</span> elem = elems[i];</span><br><span class="line">                elem.command = [];</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>, len1 = elem.attributes.length; j &lt; len1; j++)&#123;</span><br><span class="line">                    <span class="keyword">var</span> attr = elem.attributes[j];</span><br><span class="line">                    <span class="keyword">if</span>(attr.nodeName.indexOf(<span class="string">'q-'</span>) &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="comment">/**</span><br><span class="line">                         * 调用属性指令，这里可以使用数据改变检测</span><br><span class="line">                         */</span></span><br><span class="line">                        command[attr.nodeName.slice(<span class="number">2</span>)].call(elem, data[attr.nodeValue]);</span><br><span class="line">                        elem.command.push(attr.nodeName.slice(<span class="number">2</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 设置数据后扫描</span><br><span class="line">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">mvSet</span>(<span class="params">key, value</span>)</span>&#123;</span><br><span class="line">            data[key] = value;</span><br><span class="line">            scan();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 数据绑定监听</span><br><span class="line">         */</span></span><br><span class="line">        elems[<span class="number">1</span>].addEventListener(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">            mvSet(<span class="string">'value'</span>, e.target.value);</span><br><span class="line">        &#125;, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        scan();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 改变数据更新视图</span><br><span class="line">         */</span></span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            mvSet(<span class="string">'value'</span>, <span class="string">'fuck'</span>);</span><br><span class="line">        &#125;,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">    </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2_u3001_u810F_u68C0_u67E5_u673A_u5236"><a href="#2_u3001_u810F_u68C0_u67E5_u673A_u5236" class="headerlink" title="2、脏检查机制"></a>2、脏检查机制</h4><p>&emsp;&emsp;以典型的mvvm框架angularjs为代表，angular通过检查脏数据来进行UI层的操作更新。关于angular的脏检测，有几点需要了解些：</p>
<ul>
<li>脏检测机制并不是使用定时检测。</li>
<li>脏检测的时机是在数据发生变化时进行。</li>
<li>angular对常用的dom事件，xhr事件等做了封装， 在里面触发进入angular的digest流程。</li>
<li>在digest流程里面， 会从rootscope开始遍历， 检查所有的watcher。<br>（关于angular的具体设计可以看其他文档，这里只讨论数据绑定），那我们看下脏检测该如何去做：主要是通过设置的数据来需找与该数据相关的所有元素，然后再比较数据变化，如果变化则进行指令操作</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>data-binding-drity-check<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">q-event</span>=<span class="value">"value"</span> <span class="attribute">ng-bind</span>=<span class="value">"value"</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">id</span>=<span class="value">"input"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">q-event</span>=<span class="value">"text"</span> <span class="attribute">ng-bind</span>=<span class="value">"value"</span> <span class="attribute">id</span>=<span class="value">"el"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> elems = [<span class="built_in">document</span>.getElementById(<span class="string">'el'</span>), <span class="built_in">document</span>.getElementById(<span class="string">'input'</span>)];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> data = &#123;</span><br><span class="line">        value: <span class="string">'hello!'</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> command = &#123;</span><br><span class="line">        text: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.innerHTML = str;</span><br><span class="line">        &#125;,</span><br><span class="line">        value: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.setAttribute(<span class="string">'value'</span>, str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> scan = <span class="function"><span class="keyword">function</span>(<span class="params">elems</span>) </span>&#123;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 扫描带指令的节点属性</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = elems.length; i &lt; len; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> elem = elems[i];</span><br><span class="line">            elem.command = &#123;&#125;;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>, len1 = elem.attributes.length; j &lt; len1; j++) &#123;</span><br><span class="line">                <span class="keyword">var</span> attr = elem.attributes[j];</span><br><span class="line">                <span class="keyword">if</span> (attr.nodeName.indexOf(<span class="string">'q-event'</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">/**</span><br><span class="line">                     * 调用属性指令</span><br><span class="line">                     */</span></span><br><span class="line">                    <span class="keyword">var</span> dataKey = elem.getAttribute(<span class="string">'ng-bind'</span>) || <span class="literal">undefined</span>;</span><br><span class="line">                    <span class="comment">/**</span><br><span class="line">                     * 进行数据初始化</span><br><span class="line">                     */</span></span><br><span class="line">                    command[attr.nodeValue].call(elem, data[dataKey]);</span><br><span class="line">                    elem.command[attr.nodeValue] = data[dataKey];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 脏循环检测</span><br><span class="line">     * @param  &#123;[type]&#125; elems [description]</span><br><span class="line">     * @return &#123;[type]&#125;       [description]</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">var</span> digest = <span class="function"><span class="keyword">function</span>(<span class="params">elems</span>) </span>&#123;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 扫描带指令的节点属性</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = elems.length; i &lt; len; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> elem = elems[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>, len1 = elem.attributes.length; j &lt; len1; j++) &#123;</span><br><span class="line">                <span class="keyword">var</span> attr = elem.attributes[j];</span><br><span class="line">                <span class="keyword">if</span> (attr.nodeName.indexOf(<span class="string">'q-event'</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">/**</span><br><span class="line">                     * 调用属性指令</span><br><span class="line">                     */</span></span><br><span class="line">                    <span class="keyword">var</span> dataKey = elem.getAttribute(<span class="string">'ng-bind'</span>) || <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">/**</span><br><span class="line">                     * 进行脏数据检测，如果数据改变，则重新执行指令，否则跳过</span><br><span class="line">                     */</span></span><br><span class="line">                    <span class="keyword">if</span>(elem.command[attr.nodeValue] !== data[dataKey])&#123;</span><br><span class="line"></span><br><span class="line">                        command[attr.nodeValue].call(elem, data[dataKey]);</span><br><span class="line">                        elem.command[attr.nodeValue] = data[dataKey];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 初始化数据</span><br><span class="line">     */</span></span><br><span class="line">    scan(elems);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 可以理解为做数据劫持监听</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">$digest</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> list = <span class="built_in">document</span>.querySelectorAll(<span class="string">'[ng-bind='</span>+ value + <span class="string">']'</span>);</span><br><span class="line">        digest(list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 输入框数据绑定监听</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">document</span>.addEventListener)&#123;</span><br><span class="line">        elems[<span class="number">1</span>].addEventListener(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            data.value = e.target.value;</span><br><span class="line">            $digest(e.target.getAttribute(<span class="string">'ng-bind'</span>));</span><br><span class="line">        &#125;, <span class="literal">false</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        elems[<span class="number">1</span>].attachEvent(<span class="string">'onkeyup'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            data.value = e.target.value;</span><br><span class="line">            $digest(e.target.getAttribute(<span class="string">'ng-bind'</span>));</span><br><span class="line">        &#125;, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        data.value = <span class="string">'fuck'</span>;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 这里问啥还要执行$digest这里关键的是需要手动调用$digest方法来启动脏检测</span><br><span class="line">         */</span></span><br><span class="line">        $digest(<span class="string">'value'</span>);</span><br><span class="line">    &#125;, <span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line">    </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3_u3001_u524D_u7AEF_u6570_u636E_u52AB_u6301_28Hijacking_29"><a href="#3_u3001_u524D_u7AEF_u6570_u636E_u52AB_u6301_28Hijacking_29" class="headerlink" title="3、前端数据劫持(Hijacking)"></a>3、前端数据劫持(Hijacking)</h4><p>&emsp;&emsp;第三种方法则是avalon等框架使用的数据劫持方式。基本思路是使用Object.defineProperty对数据对象做属性get和set的监听，当有数据读取和赋值操作时则调用节点的指令，这样使用最通用的=等号赋值就可以了。具体实现如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>data-binding-hijacking<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">q-value</span>=<span class="value">"value"</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">id</span>=<span class="value">"input"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">q-text</span>=<span class="value">"value"</span> <span class="attribute">id</span>=<span class="value">"el"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> elems = [<span class="built_in">document</span>.getElementById(<span class="string">'el'</span>), <span class="built_in">document</span>.getElementById(<span class="string">'input'</span>)];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> data = &#123;</span><br><span class="line">        value: <span class="string">'hello!'</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> command = &#123;</span><br><span class="line">        text: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.innerHTML = str;</span><br><span class="line">        &#125;,</span><br><span class="line">        value: <span class="function"><span class="keyword">function</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.setAttribute(<span class="string">'value'</span>, str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> scan = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 扫描带指令的节点属性</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = elems.length; i &lt; len; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> elem = elems[i];</span><br><span class="line">            elem.command = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>, len1 = elem.attributes.length; j &lt; len1; j++) &#123;</span><br><span class="line">                <span class="keyword">var</span> attr = elem.attributes[j];</span><br><span class="line">                <span class="keyword">if</span> (attr.nodeName.indexOf(<span class="string">'q-'</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">/**</span><br><span class="line">                     * 调用属性指令</span><br><span class="line">                     */</span></span><br><span class="line">                    command[attr.nodeName.slice(<span class="number">2</span>)].call(elem, data[attr.nodeValue]);</span><br><span class="line">                    elem.command.push(attr.nodeName.slice(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> bValue;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 定义属性设置劫持</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">var</span> defineGetAndSet = <span class="function"><span class="keyword">function</span>(<span class="params">obj, propName</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(obj, propName, &#123;</span><br><span class="line"></span><br><span class="line">                get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> bValue;</span><br><span class="line">                &#125;,</span><br><span class="line">                set: <span class="function"><span class="keyword">function</span>(<span class="params">newValue</span>) </span>&#123;</span><br><span class="line">                    bValue = newValue;</span><br><span class="line">                    scan();</span><br><span class="line">                &#125;,</span><br><span class="line"></span><br><span class="line">                enumerable: <span class="literal">true</span>,</span><br><span class="line">                configurable: <span class="literal">true</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"browser not supported."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 初始化数据</span><br><span class="line">     */</span></span><br><span class="line">    scan();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 可以理解为做数据劫持监听</span><br><span class="line">     */</span></span><br><span class="line">    defineGetAndSet(data, <span class="string">'value'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 数据绑定监听</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">document</span>.addEventListener)&#123;</span><br><span class="line">        elems[<span class="number">1</span>].addEventListener(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            data.value = e.target.value;</span><br><span class="line">        &#125;, <span class="literal">false</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        elems[<span class="number">1</span>].attachEvent(<span class="string">'onkeyup'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            data.value = e.target.value;</span><br><span class="line">        &#125;, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        data.value = <span class="string">'fuck'</span>;</span><br><span class="line">    &#125;, <span class="number">2000</span>)</span><br><span class="line">    </span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&ensp;但值得注意的是defineProperty支持IE8以上的浏览器，这里可以使用<strong><strong>defineGetter</strong></strong> 和 <strong><strong>defineSetter</strong></strong> 来做兼容但是浏览器兼容性的原因，直接用defineProperty就可以了。至于IE8浏览器仍需要使用其它方法来做hack。如下代码可以对IE8进行hack，defineProperty支持IE8。例如使用es5-shim.js就可以了。（IE8以下浏览器忽略）</p>
<h4 id="4_u3001_u5C0F_u7ED3"><a href="#4_u3001_u5C0F_u7ED3" class="headerlink" title="4、小结"></a>4、小结</h4><p>&emsp;&emsp;首先这里的例子只是简单的实现，读者可以深入感受三种方式的异同点，复杂的框架也是通过这样的基本思路滚雪球滚大的。</p>
<p><a href="https://github.com/ouvens/demo-file/tree/master/two-ways-binding" target="_blank" rel="external">演示例子</a></p>
<p>参考：</p>
<p><a href="https://gist.github.com/brettz9/4093766#file_html5_dataset.js" target="_blank" rel="external">https://gist.github.com/brettz9/4093766#file_html5_dataset.js</a><br><a href="https://github.com/xufei/blog/issues/10" target="_blank" rel="external">https://github.com/xufei/blog/issues/10</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/11/26/ouvens.github.io/product-product/2015-11-26-product-dev-process/" itemprop="url">
                产品的生命周期--阅读《人人都是产品经理》总结
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-11-26T00:00:00+08:00" content="2015-11-26">
            2015-11-26
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/product-product/" itemprop="url" rel="index">
                  <span itemprop="name">product-product</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/11/26/ouvens.github.io/product-product/2015-11-26-product-dev-process/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/26/ouvens.github.io/product-product/2015-11-26-product-dev-process/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p><strong>先来张图，将本书42.2万字的文字浓缩成一张图来作总结。关于一个互联网产品，无论大小，其生命周期过程如下</strong></p>
<p><img src="http://7tszky.com1.z0.glb.clouddn.com/Fvy7vhQTsh8PKin2Kfi19cHhEVIN" alt=""><br><a href="http://7tszky.com1.z0.glb.clouddn.com/Fvy7vhQTsh8PKin2Kfi19cHhEVIN" target="_blank" rel="external">查看大图</a></p>
<p><strong>策划一个产品涉及较多的是文档，下面也总结了一些文档的通用规范</strong><br><img src="http://7tszky.com1.z0.glb.clouddn.com/Fn1hANMme6STGs6znKsGvqAe7tJw" alt=""><br><a href="http://7tszky.com1.z0.glb.clouddn.com/Fn1hANMme6STGs6znKsGvqAe7tJw" target="_blank" rel="external">查看大图</a></p>
<p>总结文档规范的原因很简单，可以帮助一个新的产品经理直接就能写出一份完善并且思路清晰的文档出来，至少第一眼看不出来是新手写的。<br>此处整理出来已经有不少东西了，不喜欢多余的文字，此图已涵盖产品生命周期的始终。读者们慢慢品味。</p>
<hr>
<h4 id="u4EA7_u54C1_u7ECF_u7406_u5B66_u4E60_u7F51_u7AD9_uFF1A"><a href="#u4EA7_u54C1_u7ECF_u7406_u5B66_u4E60_u7F51_u7AD9_uFF1A" class="headerlink" title="产品经理学习网站："></a>产品经理学习网站：</h4><p><a href="http://www.woshipm.com/" target="_blank" rel="external">人人都是产品经理</a><br><a href="http://www.chanpin100.com/" target="_blank" rel="external">产品100</a><br><a href="http://pmcaff.com/portal.php" target="_blank" rel="external">PM caff</a><br><a href="http://www.huxiu.com/" target="_blank" rel="external">虎嗅网</a><br><a href="http://www.yixieshi.com/" target="_blank" rel="external">互联网的壹些事</a><br><a href="http://www.masterchat.cn/" target="_blank" rel="external">产品邦</a><br><a href="http://www.geekpark.net/" target="_blank" rel="external">极客公园</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/11/24/ouvens.github.io/frontend-javascript/2015-11-24-es6-code-style-for-node/" itemprop="url">
                es6 编码规范全部(含node部分)
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-11-24T00:00:00+08:00" content="2015-11-24">
            2015-11-24
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/frontend-javascript/" itemprop="url" rel="index">
                  <span itemprop="name">frontend-javascript</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/11/24/ouvens.github.io/frontend-javascript/2015-11-24-es6-code-style-for-node/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/24/ouvens.github.io/frontend-javascript/2015-11-24-es6-code-style-for-node/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h1 id="JavaScript__u89C4_u8303_uFF08_u542Bnode_u90E8_u5206_uFF09"><a href="#JavaScript__u89C4_u8303_uFF08_u542Bnode_u90E8_u5206_uFF09" class="headerlink" title="JavaScript 规范（含node部分）"></a>JavaScript 规范（含node部分）</h1><ul>
<li>一、类型规范</li>
<li>二、字符串模板</li>
<li>三、数组类型</li>
<li>四、解构类型</li>
<li>五、函数</li>
<li>六、arrow箭头函数</li>
<li>七、对象</li>
<li>八、类</li>
<li>九、模块</li>
<li>十、Iterators 和 Generators</li>
<li>十一、属性访问</li>
<li>十二、map + set + weakmap + weakset 数据结构</li>
<li>十三、promise、symbols、proxies</li>
<li>十四、统一码</li>
<li>十五、进制数支持</li>
<li>十六、不建议使用reflect对象和tail calls尾调用</li>
</ul>
<h2 id="u4E00_u3001_u7C7B_u578B_u89C4_u8303"><a href="#u4E00_u3001_u7C7B_u578B_u89C4_u8303" class="headerlink" title="一、类型规范"></a>一、类型规范</h2><blockquote>
<p>对于常量或不修改的变量声明使用const，对于只在当前作用域下有效的变量，应使用let，全局变量使用var。将所有 const 变量放在一起，然后将所有 let 变量放在一起</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> foo1 = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">let</span> bar = foo;</span><br><span class="line">bar = <span class="number">9</span>;</span><br><span class="line">foo1 = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(foo, bar); <span class="comment">// =&gt; 1, 9</span></span><br><span class="line"><span class="built_in">console</span>.log(foo, bar, str); <span class="comment">// =&gt; 1, 9,'ouven'</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p> const和let使用时注意，let 和 const 都是块作用域的</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// const and let only exist in the blocks they are defined in.</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">const</span> b = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// ReferenceError</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// ReferenceError</span></span><br></pre></td></tr></table></figure>
<h2 id="u4E8C_u3001_u5B57_u7B26_u4E32"><a href="#u4E8C_u3001_u5B57_u7B26_u4E32" class="headerlink" title="二、字符串"></a>二、字符串</h2><blockquote>
<p>使用单引号 ‘</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">"Bob Parr"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'Bob Parr'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> fullName = <span class="string">"Bob "</span> + <span class="keyword">this</span>.lastName;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> fullName = <span class="string">'Bob '</span> + <span class="keyword">this</span>.lastName;</span><br></pre></td></tr></table></figure>
<p>超过80个字符的字符串应该使用字符串连接换行<br>注：如果过度使用长字符串连接可能会对性能有影响。jsPerf &amp; Discussion</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> errorMessage = <span class="string">'This is a super long error that was thrown because of Batman. When you stop to think about how Batman had anything to do with this, you would get nowhere fast.'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> errorMessage = <span class="string">'This is a super long error that \</span><br><span class="line">was thrown because of Batman. \</span><br><span class="line">When you stop to think about \</span><br><span class="line">how Batman had anything to do \</span><br><span class="line">with this, you would get nowhere \</span><br><span class="line">fast.'</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> errorMessage = <span class="string">'This is a super long error that '</span> +</span><br><span class="line">  <span class="string">'was thrown because of Batman.'</span> +</span><br><span class="line">  <span class="string">'When you stop to think about '</span> +</span><br><span class="line">  <span class="string">'how Batman had anything to do '</span> +</span><br><span class="line">  <span class="string">'with this, you would get nowhere '</span> +</span><br><span class="line">  <span class="string">'fast.'</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>编程构建字符串时，使用字符串模板而不是字符串连接</p>
</blockquote>
<p>模板给你一个可读的字符串，简洁的语法与适当的换行和字符串插值特性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'How are you, '</span> + name + <span class="string">'?'</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="string">'How are you, '</span>, name, <span class="string">'?'</span>].join();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`How are you, <span class="subst">$&#123;name&#125;</span>?`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u4E09_u3001_u6570_u7EC4_u7C7B_u578B"><a href="#u4E09_u3001_u6570_u7EC4_u7C7B_u578B" class="headerlink" title="三、数组类型"></a>三、数组类型</h2><blockquote>
<p>使用字面量语法创建数组</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> items = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> items = [];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果你不知道数组的长度，使用 push</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> someStack = [];</span><br><span class="line"> </span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line">someStack[someStack.length] = <span class="string">'abracadabra'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">someStack.push(<span class="string">'abracadabra'</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用 … 来拷贝数组，不要使用 Array.from、Array.of等数组的新的内置API，Array新api用于适合的场景</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> len = items.length;</span><br><span class="line"><span class="keyword">const</span> itemsCopy = [];</span><br><span class="line"><span class="keyword">let</span> i;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">  itemsCopy[i] = items[i];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> itemsCopy = [...items];</span><br><span class="line"></span><br><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="keyword">const</span> foo = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> nodes = <span class="built_in">Array</span>.from(foo);</span><br></pre></td></tr></table></figure>
<h2 id="u56DB_u3001_u89E3_u6784_Destructuring"><a href="#u56DB_u3001_u89E3_u6784_Destructuring" class="headerlink" title="四、解构 Destructuring"></a>四、解构 Destructuring</h2><p>使用对象的多个属性时请建议使用对象的解构赋值，解构赋值避免了为这些属性创建临时变量或对象。即使转化成es5都是一样的</p>
<blockquote>
<p> 嵌套结构的对象层数不能超过3层</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="string">'one'</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">'newTwo'</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">'three'</span>: [</span><br><span class="line">            <span class="string">'four'</span>: <span class="string">'太多层了，头晕晕'</span></span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="string">'one'</span>: [</span><br><span class="line">    <span class="string">'two'</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">'twoObj'</span>: <span class="string">'结构清晰'</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>解构语句中统一不使用圆括号</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line">[(a)] = [<span class="number">11</span>]; <span class="comment">// a未定义</span></span><br><span class="line"><span class="keyword">let</span> &#123; a: (b) &#125; = &#123;&#125;; <span class="comment">// 解析出错</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> [a, b] = [<span class="number">11</span>, <span class="number">22</span>];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>对象解构</p>
</blockquote>
<p>对象解构元素与顺序无关<br>对象指定默认值时仅对恒等于undefined ( !== null ) 的情况生效</p>
<blockquote>
<p> 若函数形参为对象时，使用对象解构赋值</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">someFun</span>(<span class="params">opt</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> opt1 = opt.opt1;</span><br><span class="line">  <span class="keyword">let</span> opt2 = opt.opt2;</span><br><span class="line">  <span class="built_in">console</span>.log(op1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">someFun</span>(<span class="params">opt</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> &#123; opt1, opt2 &#125; = opt;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`$(opt1) 加上 $(opt2)`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">someFun</span>(<span class="params">&#123; opt1, opt2 &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(opt1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p> 若函数有多个返回值时，使用对象解构，不使用数组解构，避免添加顺序的问题</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anotherFun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> one = <span class="number">1</span>, two = <span class="number">2</span>, three = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">return</span> [one, two, three];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> [one, three, two] = anotherFun(); <span class="comment">// 顺序乱了</span></span><br><span class="line"><span class="comment">// one = 1, two = 3, three = 2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anotherFun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> one = <span class="number">1</span>, two = <span class="number">2</span>, three = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123; one, two, three &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> &#123; one, three, two &#125; = anotherFun(); <span class="comment">// 不用管顺序</span></span><br><span class="line"><span class="comment">// one = 1, two = 2, three = 3</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p> 已声明的变量不能用于解构赋值（语法错误）</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法错误</span></span><br><span class="line"><span class="keyword">let</span> a;</span><br><span class="line">&#123; a &#125; = &#123; b: <span class="number">123</span>&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>数组解构时数组元素与顺序相关</p>
</blockquote>
<p>例如交换数组两个元素的值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> y = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="keyword">let</span> temp;</span><br><span class="line">temp = x;</span><br><span class="line">x = y;</span><br><span class="line">y = temp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">[x, y] = [y, x]; <span class="comment">// 交换变量</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>将数组成员赋值给变量时，使用数组解构</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="keyword">const</span> one = arr[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">const</span> two = arr[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> [one, two] = arr;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>函数有多个返回值时使用对象解构，而不是数组解构。</p>
</blockquote>
<p>这样你就可以随时添加新的返回值或任意改变返回值的顺序，而不会导致调用失败。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">processInput</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// then a miracle occurs</span></span><br><span class="line">    <span class="keyword">return</span> [left, right, top, bottom];</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// the caller needs to think about the order of return data</span></span><br><span class="line">  <span class="keyword">const</span> [left, __, top] = processInput(input);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// good</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">processInput</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// then a miracle occurs</span></span><br><span class="line">    <span class="keyword">return</span> &#123; left, right, top, bottom &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// the caller selects only the data they need</span></span><br><span class="line">  <span class="keyword">const</span> &#123; left, right &#125; = processInput(input);</span><br></pre></td></tr></table></figure>
<h2 id="u4E94_u3001_u51FD_u6570"><a href="#u4E94_u3001_u51FD_u6570" class="headerlink" title="五、函数"></a>五、函数</h2><blockquote>
<p>使用函数声明而不是函数表达式</p>
</blockquote>
<p>函数声明拥有函数名，在调用栈中更加容易识别。并且，函数声明会整体提升，而函数表达式只会提升变量本身。这条规则也可以这样描述，始终使用箭头函数来代替函数表达式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>绝对不要在一个非函数块（if，while，等等）里声明一个函数，把那个函数赋给一个变量。浏览器允许你这么做，但是它们解析不同<br>注：ECMA-262 把 块 定义为一组语句，函数声明不是一个语句。阅读 ECMA-262 对这个问题的说明</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">if</span> (currentUser) &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Nope.'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">if</span> (currentUser) &#123;</span><br><span class="line">  <span class="keyword">var</span> test = <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Yup.'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>绝对不要把参数命名为 arguments, 这将会覆盖函数作用域内传过来的 arguments 对象</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nope</span>(<span class="params">name, options, arguments</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...stuff...</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">yup</span>(<span class="params">name, options, args</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...stuff...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>永远不要使用 arguments，使用 … 操作符来代替</p>
</blockquote>
<p>… 操作符可以明确指定你需要哪些参数，并且得到的是一个真实的数组，而不是 arguments 这样的类数组对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">  <span class="keyword">return</span> args.join(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> args.join(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用函数参数默认值语法，而不是修改函数的实参</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// really bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts</span>) </span>&#123;</span><br><span class="line">  opts = opts || &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// still bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (opts === <span class="keyword">void</span> <span class="number">0</span>) &#123;</span><br><span class="line">    opts = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u516D_u3001_u7BAD_u5934_u51FD_u6570_Arrow_Functions"><a href="#u516D_u3001_u7BAD_u5934_u51FD_u6570_Arrow_Functions" class="headerlink" title="六、箭头函数 Arrow Functions"></a>六、箭头函数 Arrow Functions</h2><blockquote>
<p>当必须使用函数表达式时（例如传递一个匿名函数时），请使用箭头函数</p>
</blockquote>
<p>箭头函数提供了更简洁的语法，并且箭头函数中 this 对象的指向是不变的，this 对象绑定定义时所在的对象，这通常是我们想要的。如果该函数的逻辑非常复杂，请将该函数提取为一个函数声明。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="pi">"use strict"</span>;</span><br><span class="line"><span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">v</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">console</span>.log(v);</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> fn= (v=&gt;<span class="built_in">console</span>.log(v));</span><br></pre></td></tr></table></figure>
<blockquote>
<p>箭头函数总是用括号包裹参数，省略括号只适用于单个参数，并且还降低了程序的可读性</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].forEach(x =&gt; x * x);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].forEach((x) =&gt; x * x);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>立即执行的匿名函数</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数表达式</span></span><br><span class="line"><span class="comment">// immediately-invoked function expression (IIFE)</span></span><br><span class="line"><span class="comment">// good，看起来就很厉害</span></span><br><span class="line">(() =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Welcome to the Internet. Please follow me.'</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h2 id="u4E03_u3001_u5BF9_u8C61"><a href="#u4E03_u3001_u5BF9_u8C61" class="headerlink" title="七、对象"></a>七、对象</h2><blockquote>
<p>使用对象字面量创建对象</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> item = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> item = &#123;&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不要使用保留字（reserved words）作为键，否则在 IE8 下将出错</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// bad</span><br><span class="line">var superman = &#123;</span><br><span class="line">  class: 'superhero',</span><br><span class="line">  default: &#123; clark: 'kent' &#125;,</span><br><span class="line">  private: true</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">// good</span><br><span class="line">var superman = &#123;</span><br><span class="line">  klass: 'superhero',</span><br><span class="line">  defaults: &#123; clark: 'kent' &#125;,</span><br><span class="line">  hidden: true</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建对象时使用计算的属性名，而不要在创建对象后使用对象的动态特性，这样可以在同一个位置定义对象的所有属性。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getKey</span>(<span class="params">k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`a key named <span class="subst">$&#123;k&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// bad</span></span><br><span class="line">  <span class="keyword">const</span> obj = &#123;</span><br><span class="line">    id: <span class="number">5</span>,</span><br><span class="line">    name: <span class="string">'San Francisco'</span></span><br><span class="line">  &#125;;</span><br><span class="line">  obj[getKey(<span class="string">'enabled'</span>)] = <span class="literal">true</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// good</span></span><br><span class="line">  <span class="keyword">const</span> obj = &#123;</span><br><span class="line">    id: <span class="number">5</span>,</span><br><span class="line">    name: <span class="string">'San Francisco'</span>,</span><br><span class="line">    [getKey(<span class="string">'enabled'</span>)]: <span class="literal">true</span></span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用定义对象方法的简短形式</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> atom = &#123;</span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line"> </span><br><span class="line">  addValue: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> atom.value + value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> atom = &#123;</span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line"> </span><br><span class="line">  addValue(value) &#123;</span><br><span class="line">    <span class="keyword">return</span> atom.value + value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用定义对象属性的简短形式，书写起来更加简单，并且可以自描述。这里和es5有些不同，需要注意下</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> lukeSkywalker = <span class="string">'Luke Skywalker'</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// bad</span></span><br><span class="line">  <span class="keyword">const</span> obj = &#123;</span><br><span class="line">    lukeSkywalker: lukeSkywalker</span><br><span class="line">  &#125;;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// good</span></span><br><span class="line">  <span class="keyword">const</span> obj = &#123;</span><br><span class="line">    lukeSkywalker</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>将所有简写的属性写在对象定义的最顶部，这样可以更加方便地知道哪些属性使用了简短形式。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> anakinSkywalker = <span class="string">'Anakin Skywalker'</span>;</span><br><span class="line"><span class="keyword">const</span> lukeSkywalker = <span class="string">'Luke Skywalker'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  episodeOne: <span class="number">1</span>,</span><br><span class="line">  twoJedisWalkIntoACantina: <span class="number">2</span>,</span><br><span class="line">  lukeSkywalker,</span><br><span class="line">  episodeThree: <span class="number">3</span>,</span><br><span class="line">  mayTheFourth: <span class="number">4</span>,</span><br><span class="line">  anakinSkywalker</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  lukeSkywalker,</span><br><span class="line">  anakinSkywalker,</span><br><span class="line">  episodeOne: <span class="number">1</span>,</span><br><span class="line">  twoJedisWalkIntoACantina: <span class="number">2</span>,</span><br><span class="line">  episodeThree: <span class="number">3</span>,</span><br><span class="line">  mayTheFourth: <span class="number">4</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="u516B_u3001_u7C7B"><a href="#u516B_u3001_u7C7B" class="headerlink" title="八、类"></a>八、类</h2><blockquote>
<p>总是使用 class 关键字，避免直接修改 prototype，class 语法更简洁，也更易理解。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queue</span>(<span class="params">contents = []</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>._queue = [...contents];</span><br><span class="line">&#125;</span><br><span class="line">Queue.prototype.pop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> value = <span class="keyword">this</span>._queue[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">this</span>._queue.splice(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span> </span>&#123;</span><br><span class="line">  constructor(contents = []) &#123;</span><br><span class="line">    <span class="keyword">this</span>._queue = [...contents];</span><br><span class="line">  &#125;</span><br><span class="line">  pop() &#123;</span><br><span class="line">    <span class="keyword">const</span> value = <span class="keyword">this</span>._queue[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">this</span>._queue.splice(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>类名与花括号须保留一个空格间距，类中的方法定义时，括号 ) 也须与花括号 { 保留一个空格间距</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span>&#123;</span><br><span class="line">  constructor()&#123;</span><br><span class="line">    <span class="comment">// constructor</span></span><br><span class="line">  &#125;</span><br><span class="line">  sayHi()    &#123;</span><br><span class="line">    <span class="comment">// 仅保留一个空格间距</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    <span class="comment">// constructor</span></span><br><span class="line">  &#125;</span><br><span class="line">  sayHi() &#123;</span><br><span class="line">    <span class="comment">// 仅保留一个空格间距</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>定义类时，方法的顺序如下：</p>
</blockquote>
<ul>
<li>constructor</li>
<li>public get/set 公用访问器，set只能传一个参数</li>
<li>public methods 公用方法，公用相关命名使用小驼峰式写法(lowerCamelCase)</li>
<li>private get/set 私有访问器，私有相关命名应加上下划线 _ 为前缀</li>
<li>private methods 私有方法</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    <span class="comment">// constructor</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  get aval() &#123;</span><br><span class="line">    <span class="comment">// public getter</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  set aval(val) &#123;</span><br><span class="line">    <span class="comment">// public setter</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  doSth() &#123;</span><br><span class="line">    <span class="comment">// 公用方法</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  get _aval() &#123;</span><br><span class="line">    <span class="comment">// private getter</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  set _aval() &#123;</span><br><span class="line">    <span class="comment">// private setter</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _doSth() &#123;</span><br><span class="line">    <span class="comment">// 私有方法</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果不是class类，不使用new</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> foo = <span class="keyword">new</span> Foo();</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> foo = <span class="keyword">new</span> Foo();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用 extends 关键字来继承</p>
</blockquote>
<p>这是一个内置的继承方式，并且不会破坏 instanceof 原型检查。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line">  <span class="keyword">const</span> inherits = <span class="built_in">require</span>(<span class="string">'inherits'</span>);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">PeekableQueue</span>(<span class="params">contents</span>) </span>&#123;</span><br><span class="line">    Queue.apply(<span class="keyword">this</span>, contents);</span><br><span class="line">  &#125;</span><br><span class="line">  inherits(PeekableQueue, Queue);</span><br><span class="line">  PeekableQueue.prototype.peek = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._queue[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// good</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">PeekableQueue</span> <span class="keyword">extends</span> <span class="title">Queue</span> </span>&#123;</span><br><span class="line">    peek() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>._queue[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="u4E5D_u3001_u6A21_u5757"><a href="#u4E5D_u3001_u6A21_u5757" class="headerlink" title="九、模块"></a>九、模块</h2><p>总是在非标准的模块系统中使用标准的 import 和 export 语法，我们总是可以将标准的模块语法转换成支持特定模块加载器的语法。</p>
<blockquote>
<p>推荐使用import和export来做模块加载</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> AirbnbStyleGuide = <span class="built_in">require</span>(<span class="string">'./AirbnbStyleGuide'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = AirbnbStyleGuide.es6;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ok</span></span><br><span class="line"><span class="keyword">import</span> AirbnbStyleGuide <span class="keyword">from</span> <span class="string">'./AirbnbStyleGuide'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> AirbnbStyleGuide.es6;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// best</span></span><br><span class="line"><span class="keyword">import</span> &#123; es6 &#125; <span class="keyword">from</span> <span class="string">'./AirbnbStyleGuide'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> es6;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>import / export 后面采用花括号{ }引入模块的写法时，建议在花括号内左右各保留一个空格</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="keyword">import</span> &#123;lightRed&#125; <span class="keyword">from</span> <span class="string">'./colors'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; lightRed&#125; <span class="keyword">from</span> <span class="string">'./colors'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">import</span> &#123; lightRed &#125; <span class="keyword">from</span> <span class="string">'./colors'</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不要使用通配符 * 的 import，这样确保了一个模块只有一个默认的 export 项</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> AirbnbStyleGuide <span class="keyword">from</span> <span class="string">'./AirbnbStyleGuide'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">import</span> AirbnbStyleGuide <span class="keyword">from</span> <span class="string">'./AirbnbStyleGuide'</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不要直接从一个 import 上 export</p>
</blockquote>
<p>虽然一行代码看起来更简洁，但是有一个明确的 import 和一个明确的 export 使得代码行为更加明确。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="comment">// filename es6.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; es6 &#125; from <span class="string">'./airbnbStyleGuide'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="comment">// filename es6.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; es6 &#125; <span class="keyword">from</span> <span class="string">'./AirbnbStyleGuide'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> es6;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>多变量要导出时应采用对象解构形式</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a= <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> b= <span class="string">'b'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a= <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> b= <span class="string">'b'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; a, b &#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>导出单一一个类时，确保你的文件名就是你的类名</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// file contents</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CheckBox</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = CheckBox;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// in some other file</span></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> CheckBox = <span class="built_in">require</span>(<span class="string">'./checkBox'</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> CheckBox = <span class="built_in">require</span>(<span class="string">'./check_box'</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> CheckBox = <span class="built_in">require</span>(<span class="string">'./CheckBox'</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>导出一个默认小驼峰命名的函数时，文件名应该就是导出的方法名</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeStyleGuide</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> makeStyleGuide;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>导出单例、函数库或裸对象时，使用大驼峰命名规则</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> AirbnbStyleGuide = &#123;</span><br><span class="line">  es6: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> AirbnbStyleGuide;</span><br></pre></td></tr></table></figure>
<h2 id="u5341_u3001Iterators__u548C_Generators"><a href="#u5341_u3001Iterators__u548C_Generators" class="headerlink" title="十、Iterators 和 Generators"></a>十、Iterators 和 Generators</h2><blockquote>
<p>Iterators。性能比较差，对于数组来说大致与Array.prototype.forEach相当，比不过原生的for循环，而且用起来比较麻烦，数组提供了for…of，对象提供了for…in，不推荐使用迭代器。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> iterator = numbers[<span class="built_in">Symbol</span>.iterator]();  </span><br><span class="line"><span class="keyword">var</span> result = iterator.next();</span><br><span class="line"><span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (!result.done) &#123;</span><br><span class="line">  sum += result.value;</span><br><span class="line">  result = iterator.next();  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> num <span class="keyword">of</span> numbers) &#123;</span><br><span class="line">  sum += num;</span><br><span class="line">&#125;</span><br><span class="line">sum === <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line">numbers.forEach((num) =&gt; sum += num);</span><br><span class="line">sum === <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// best (use the functional force)</span></span><br><span class="line"><span class="keyword">const</span> sum = numbers.reduce((total, num) =&gt; total + num, <span class="number">0</span>);</span><br><span class="line">sum === <span class="number">15</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>generators。不推荐使用，或者非常谨慎地使用。</p>
</blockquote>
<p>生成器不是用来写异步的，虽然确实有这样一个效果，但这仅仅是一种Hack。异步在未来一定是属于async和await这两个关键字的，但太多人眼里生成器就是写异步用的，这会导致滥用。暂时推荐用promise来实现异步。</p>
<h2 id="u5341_u4E00_u3001_u5C5E_u6027_u8BBF_u95EE"><a href="#u5341_u4E00_u3001_u5C5E_u6027_u8BBF_u95EE" class="headerlink" title="十一、属性访问"></a>十一、属性访问</h2><blockquote>
<p>使用点 . 操作符来访问常量属性</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> luke = &#123;</span><br><span class="line">  jedi: <span class="literal">true</span>,</span><br><span class="line">  age: <span class="number">28</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> isJedi = luke[<span class="string">'jedi'</span>];</span><br><span class="line"> </span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> isJedi = luke.jedi;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用中括号[] 操作符来访问变量属性</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> luke = &#123;</span><br><span class="line">  jedi: <span class="literal">true</span>,</span><br><span class="line">  age: <span class="number">28</span></span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getProp</span>(<span class="params">prop</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> luke[prop];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> isJedi = getProp(<span class="string">'jedi'</span>);</span><br></pre></td></tr></table></figure>
<h2 id="u5341_u4E8C_u3001map_+_set_+_weakmap_+_weakset__u6570_u636E_u7ED3_u6784"><a href="#u5341_u4E8C_u3001map_+_set_+_weakmap_+_weakset__u6570_u636E_u7ED3_u6784" class="headerlink" title="十二、map + set + weakmap + weakset 数据结构"></a>十二、map + set + weakmap + weakset 数据结构</h2><blockquote>
<p>新加的集合类型，提供了更加方便的获取属性值的方法，可以检查某个属性是属于原型链上还是当前对象的，并用获取对象的set和get方法</p>
<p>但是，推荐使用weakmap和weakset，而不是map和set，除非必须使用。普通集合会阻止垃圾回收器对这些作为属性键存在的对象的回收，有造成内存泄漏的危险</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good, Maps</span></span><br><span class="line"><span class="keyword">var</span> wm = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">wm.set(key, &#123; extra: <span class="number">42</span> &#125;);</span><br><span class="line">wm.size === <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// not good, Sets</span></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line">ws.add(&#123; data: <span class="number">42</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good, Weak Maps</span></span><br><span class="line"><span class="keyword">var</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line">wm.set(key, &#123; extra: <span class="number">42</span> &#125;);</span><br><span class="line">wm.size === <span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// good, Weak Sets</span></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line">ws.add(&#123; data: <span class="number">42</span> &#125;);<span class="comment">//因为添加到ws的这个临时对象没有其他变量引用它，所以ws不会保存它的值，也就是说这次添加其实没有意思</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="keyword">let</span> object = &#123;&#125;,</span><br><span class="line">object.hasOwnProperty(key)</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> object = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line">object.has(key) === <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>当你的元素或者键值有可能不是字符串时，推荐使用WeakMap和WeakSet。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="number">3</span>:<span class="string">'value'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line">ws.add(<span class="number">3</span>, <span class="string">'value'</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>有移除操作的需求时，使用WeakMap和WeakSet。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="string">'key'</span>:<span class="string">'value'</span> &#125;;</span><br><span class="line"><span class="keyword">delete</span> obj.key;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line">ws.add(<span class="string">'key'</span>, <span class="string">'value'</span>);</span><br><span class="line">ws.remove(<span class="string">'key'</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>当仅需要一个不可重复的集合时，使用WeakSet优先于普通对象，而不要使用{foo: true}这样的对象。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="string">'key'</span>:<span class="string">'value'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line">ws.add(<span class="string">'key'</span>, <span class="string">'value'</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>当需要遍历功能时，使用WeakMap和WeakSet，因为其可以简单地使用for..of进行遍历，性能更高</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123; key:<span class="string">'value'</span>, key1: <span class="string">'value1'</span> &#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj)&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line">ws.add(<span class="string">'key'</span>, <span class="string">'value'</span>).add(<span class="string">'key1'</span>, <span class="string">'value1'</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">of</span> ws)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u5341_u4E09_u3001promise_u3001symbols_u3001proxies"><a href="#u5341_u4E09_u3001promise_u3001symbols_u3001proxies" class="headerlink" title="十三、promise、symbols、proxies"></a>十三、promise、symbols、proxies</h2><blockquote>
<p>promise是一种异步处理模式。发promise申明和调用分开，推荐异步方式使用Promise。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// not good</span></span><br><span class="line">(<span class="keyword">new</span> <span class="built_in">Promise</span>(resolve, reject)&#123;&#125;)</span><br><span class="line">  .then(cunction()&#123;&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)</span><br><span class="line">  .then();</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> Primise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;&#125;);</span><br><span class="line">promise</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;]&#125;)</span><br><span class="line">  .then();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>symbol用于对象的键和私有属性，使用过于复杂，没有使用必要，容易扰乱外层作用域。总之不要使用</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyClass</span>(<span class="params">privateData</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> key = privateData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//not good</span></span><br><span class="line"><span class="keyword">const</span> key = <span class="built_in">Symbol</span>(<span class="string">'key'</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyClass</span>(<span class="params">privateData</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>[key] = privateData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> object = <span class="keyword">new</span> MyClass(<span class="string">"hello"</span>)</span><br><span class="line">object[<span class="string">'key'</span>] === <span class="literal">undefined</span> <span class="comment">//无法访问该属性，因为是私有的</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Proxy可以监听对象身上发生了什么事情，并在这些事情发生后执行一些相应的操作，没有特别要注意的，尽情用吧。</p>
</blockquote>
<h2 id="u5341_u56DB_u3001_u4E0D_u8981_u4F7F_u7528_u7EDF_u4E00_u7801"><a href="#u5341_u56DB_u3001_u4E0D_u8981_u4F7F_u7528_u7EDF_u4E00_u7801" class="headerlink" title="十四、不要使用统一码"></a>十四、不要使用统一码</h2><blockquote>
<p>字符串支持新的Unicode文本形式，也增加了新的正则表达式修饰符u来处理码位，但是一般不要这样处理，会减低程序可读性且处理统一码速度会降低</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="string">'字符串'</span>.length == <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 新加的：正则支持统一码'u'， 但仍建议不使用</span></span><br><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="string">'字符串'</span>.match(<span class="regexp">/./u</span>)[<span class="number">0</span>].length == <span class="number">6</span></span><br><span class="line"><span class="string">'字符串'</span>.codePointAt(<span class="number">0</span>) == <span class="number">0x20BB7</span></span><br></pre></td></tr></table></figure>
<h2 id="u5341_u4E94_u3001_u8FDB_u5236_u6570_u652F_u6301"><a href="#u5341_u4E94_u3001_u8FDB_u5236_u6570_u652F_u6301" class="headerlink" title="十五、进制数支持"></a>十五、进制数支持</h2><blockquote>
<p>加入对二进制(b)和八进制(o)字面量的支持。该特性可以使用</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ok</span></span><br><span class="line"><span class="number">0b111110111</span> === <span class="number">503</span> <span class="comment">// true</span></span><br><span class="line"><span class="number">0o767</span> === <span class="number">503</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="u5341_u516D_u3001_u4E0D_u5EFA_u8BAE_u4F7F_u7528reflect_u5BF9_u8C61_u548Ctail_calls_u5C3E_u8C03_u7528"><a href="#u5341_u516D_u3001_u4E0D_u5EFA_u8BAE_u4F7F_u7528reflect_u5BF9_u8C61_u548Ctail_calls_u5C3E_u8C03_u7528" class="headerlink" title="十六、不建议使用reflect对象和tail calls尾调用"></a>十六、不建议使用reflect对象和tail calls尾调用</h2><blockquote>
<p>没有使用的必要性</p>
</blockquote>
<h2 id="u53C2_u8003_uFF1A"><a href="#u53C2_u8003_uFF1A" class="headerlink" title="参考："></a>参考：</h2><p><a href="http://bubkoo.com/2015/04/05/javascript-style-guide/?utm_source=tuicool" target="_blank" rel="external">http://bubkoo.com/2015/04/05/javascript-style-guide/?utm_source=tuicool</a><br><a href="https://github.com/gf-rd/es6-coding-style#%E5%A3%B0%E6%98%8E" target="_blank" rel="external">https://github.com/gf-rd/es6-coding-style#%E5%A3%B0%E6%98%8E</a><br><a href="https://github.com/ES-CN/es6features/blob/master/README.md?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">https://github.com/ES-CN/es6features/blob/master/README.md?utm_source=tuicool&amp;utm_medium=referral</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/11/17/ouvens.github.io/Frontend-weboptimize/2015-11-17-front-end-image-optmize/" itemprop="url">
                web前端图片极限优化策略
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-11-17T00:00:00+08:00" content="2015-11-17">
            2015-11-17
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/frontend-weboptimize/" itemprop="url" rel="index">
                  <span itemprop="name">frontend-weboptimize</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/11/17/ouvens.github.io/Frontend-weboptimize/2015-11-17-front-end-image-optmize/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/17/ouvens.github.io/Frontend-weboptimize/2015-11-17-front-end-image-optmize/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>&emsp;&emsp;随着web的发展，网站资源的流量也变得越来越大。据统计，60%的网站流量均来自网站图片，可见对图片合理优化可以大幅影响网站流量，减小带宽消耗和服务器压力。</p>
<h4 id="u4E00_u3001_u73B0_u6709web_u56FE_u7247_u683C_u5F0F"><a href="#u4E00_u3001_u73B0_u6709web_u56FE_u7247_u683C_u5F0F" class="headerlink" title="一、现有web图片格式"></a>一、现有web图片格式</h4><p>我们先来看下现在常用的web图片的格式：</p>
<table>
<thead>
<tr>
<th>图片格式</th>
<th>支持透明</th>
<th>动画支持</th>
<th>压缩方式</th>
<th>浏览器支持</th>
<th>相对原图大小</th>
<th>适应场景</th>
</tr>
</thead>
<tbody>
<tr>
<td>baseline-jpeg</td>
<td>不支持</td>
<td>不支持</td>
<td>有损</td>
<td>所有</td>
<td>由画质决定</td>
<td>所有通用场景</td>
</tr>
<tr>
<td>progressive-jpeg</td>
<td>不支持</td>
<td>不支持</td>
<td>有损</td>
<td>所有</td>
<td>由画质决定</td>
<td>所有通用场景, 渐进式加载</td>
</tr>
<tr>
<td>gif</td>
<td>支持</td>
<td>支持</td>
<td>无损</td>
<td>所有</td>
<td>由帧数和每帧图片大小决定</td>
<td>简单颜色，动画</td>
</tr>
<tr>
<td>png</td>
<td>支持</td>
<td>不支持</td>
<td>无损</td>
<td>所有</td>
<td>由png色值位数决定</td>
<td>需要透明时</td>
</tr>
<tr>
<td>webp</td>
<td>支持</td>
<td>不支持</td>
<td>有损</td>
<td>Chrome、Opera</td>
<td>由压缩率决定</td>
<td>复杂颜色及形状，浏览器平台可预知</td>
</tr>
<tr>
<td>apng</td>
<td>支持</td>
<td>支持</td>
<td>无损</td>
<td>Firefox、Safari、iOS Safari</td>
<td>由每帧图片决定</td>
<td>需要半透明效果的动画</td>
</tr>
<tr>
<td>svg</td>
<td>支持</td>
<td>支持</td>
<td>无损</td>
<td>所有(IE8以上)</td>
<td>由内容和特效复杂度决定</td>
<td>简单图形，需要良好的放缩体验，需要动态控制图片特效</td>
</tr>
<tr>
<td>bpg</td>
<td>支持</td>
<td>支持</td>
<td>有损</td>
<td>不支持，需要js解码</td>
<td>由画质决定</td>
<td>jpeg上需要极限优化的场景</td>
</tr>
</tbody>
</table>
<p><strong>几种文件格式的特点概述</strong></p>
<ul>
<li><p><strong>baseline-jpeg</strong><br>  这种类型的JPEG文件存储方式是按从上到下的扫描方式，把每一行顺序的保存在JPEG文件中。打开这个文件显示它的内容时，数据将按照存储时的顺序从上到下一行一行的被显示出来，直到所有的数据都被读完，就完成了整张图片的显示。如果文件较大或者网络下载速度较慢，那么就会看到图片被一行行加载的效果，这种格式的JPEG没有什么优点，因此，一般都推荐使用Progressive JPEG</p>
</li>
<li><p><strong>preogressive-jpeg</strong><br>  和Baseline一遍扫描不同，Progressive JPEG文件包含多次扫描，这些扫描顺寻的存储在JPEG文件中。打开文件过程中，会先显示整个图片的模糊轮廓，随着扫描次数的增加，图片变得越来越清晰。这种格式的主要优点是在网络较慢的情况下，可以看到图片的轮廓知道正在加载的图片大概是什么。<br>  __这两种jpeg格式文件的效果对比如下：</p>
<p>  <img src="http://7tszky.com1.z0.glb.clouddn.com/Fo8q3huYFyQma_rsSvo28dUyd7mN" alt=""></p>
<p>  jpeg优势：<br>  非常通用，JPEG在色调及颜色平滑变化的相片或是写实绘画（painting）上可以达到它最佳的效果。</p>
<p>  jpeg劣势：<br>  它并不适合于线条绘图（drawing）和其他文字或图示（iconic）的图形,因为它的压缩方法用在这些图形的型态上,会得到不适当的结果；</p>
</li>
</ul>
<ul>
<li><p><strong>gif</strong><br>  GIF(Graphics Interchange Format)的原义是“图像互换格式”，GIF文件的数据，是一种基于LZW算法(串表压缩算法)连续色调的无损压缩格式。是目前web网页中十分常用的一种动画文件格式。<br>  优势：</p>
<ol>
<li>优秀的压缩算法使其在一定程度上保证图像质量的同时将体积变得很小</li>
<li>可插入多帧,从而实现动画效果</li>
<li><p>可设置透明色以产生对象浮现于背景之上的效果</p>
<p>劣势：<br>　由于采用了8位压缩,最多只能处理256种颜色（2的8次方）,故不宜应用于真彩图像。</p>
</li>
</ol>
</li>
<li><p><strong>png</strong><br>  png文件分为png8(8位透明png)、png24(256色png)、png32(多阶透明png)，png的有点在于使用位图实现web上的透明图片，以实现比较好的体验。<br>  <img src="http://7tszky.com1.z0.glb.clouddn.com/FnRWuq6-ElyEqZIw0MrUiXaSL3e7" alt=""></p>
<p>  优势：</p>
<ul>
<li>支持256色调色板技术以产生小体积文件</li>
<li>最高支持48位真彩色图像以及16位灰度图像。</li>
<li>支持Alpha通道的半透明特性。</li>
<li>支持图像亮度的gamma校正信息。- 支持存储附加文本信息,以保留图像名称、作者、版权、创作时间、注释等信息。</li>
<li>使用无损压缩。</li>
<li>渐近显示和流式读写,适合在网络传输中快速显示预览效果后再展示全貌。</li>
<li>使用CRC循环冗余编码防止文件出错。</li>
<li><p>最新的PNG标准允许在一个文件内存储多幅图像。</p>
<p>劣势：</p>
</li>
<li>但也有一些软件不能使用适合的预测，生成的文件较大(IE6只支持PNG8)</li>
</ul>
</li>
<li><p><strong>webp</strong></p>
<p>  目前移动端Android4.0以上、PC端chorme 10+（14 ~ 16 有渲染bug）、opera 11+ 、safri均支持webp格式图片。<br>  WEBP与JPG相比较，编码速度慢10倍，解码速度慢1.5倍，而绝大部分的网络应用中，图片都是静态文件，所以对于用户使用只需要关心解码速度即可。但实际上，webp虽然会增加额外的解码时间，但是由于减少了文件体积，缩短了加载的时间，实际上文件的渲染速度反而变快了。</p>
<p>  <a href="http://www.webpagetest.org/video/view.php?id=130125_7b15e676f5fa0b736f247ff0ed36517e64d9c9ea" target="_blank" rel="external">图片加载测试样例</a></p>
</li>
</ul>
<pre><code>webp上目前可行的应用场景：
- 1.客户端软件，内嵌了基于Chromium的webview，这类浏览器中应用的网页是可以完全使用webp格式，提升加载渲染速度，不考虑兼容。
- 2.用node-webkit开发的程序，用webp可以减少文件包的体积。
- 3.移动应用 或 网页游戏 ,界面需要大量图片,可以嵌入webp的解码包,能够节省用户流量，提升访问速度

优势：
- 对于png图片,webp比png小了45%,但是缺点是你压缩的时候需要的时间更久了；

劣势：
- 兼容性不太好, 只有opera,和chrome支持;
</code></pre><ul>
<li><p><strong>apng</strong></p>
<p>  简单来讲apng格式图片使用多个单张png连接起来的动画图片格式，支持全透明通道动画。相比于gif动画，没有毛刺，质量更高，但目前支持的浏览器并不完全。可以去can i use查看其兼容性。目前可用性相对较低，适用于对动画质量要求很高的情况。</p>
</li>
<li><p><strong>svg</strong><br>  是一种矢量图片，支持透明，缩放，动画，除了android 2.3的手机，其它场景都支持，是一种比较好的图片代替方案。<br>  优势：</p>
<ul>
<li>矢量图形，不受像素影响——SVG的这个特性使得它在不同的平台或者媒体下表现良好，无论屏幕分辨率如何</li>
<li>SVG对动画的支持较好；其DOM结构可以被其特定语法或者Javascript控制，从而轻松的实现动画</li>
<li>Javascript可以完全控制SVG Dom 元素</li>
<li><p>SVG的结构是 XML，其可访问性（盲文、声音朗读等）、可操作性、可编程性、可被CSS样式化完胜Canvas。另外，其支持 ARIA 属性，使其如虎添翼。</p>
<p>劣势：</p>
</li>
<li>DOM比正常的图形慢，而且如果其结点多而杂，就更慢了</li>
<li>不适合网页游戏等；当然，我们可以结合 Canvas + SVG来实现</li>
</ul>
</li>
<li><p><strong>bpg</strong></p>
<p>  <a href="http://bellard.org/bpg/" target="_blank" rel="external">http://bellard.org/bpg/</a><br>  <a href="http://xooyoozoo.github.io/yolo-octo-bugfixes/#avenches&amp;bpg=s&amp;bpg=s" target="_blank" rel="external">图片画质比较</a><br>  <a href="http://blog.ibireme.com/2015/11/02/mobile_image_benchmark/" target="_blank" rel="external">性能测试对比</a></p>
<p>  BPG (Better Portable Graphics) 是一个新的图片格式。用来代替jpeg和webp的方案。这种格式主要有以下特点<br>  优势：</p>
<ul>
<li>高压缩比。在画质相同的情况下比jpeg小的多</li>
<li>使用一个很小的js解码器就可以被浏览器支持</li>
<li>基于高清视频压缩标准 (HEVC) 一个子集开发 </li>
<li>支持和jpeg相同的色值，并且在有损压缩的通知支持透明，</li>
<li>单通道支持8到14位色值区域</li>
<li>支持有损压缩</li>
<li>可以添加更多的元数据编码</li>
<li>支持动画</li>
<li><p>相近画质前提下比webp更小</p>
<p>性能：</p>
</li>
<li>根据mozilla的研究，bpg使用的HEVC编码比原生的HEVC性能更好，因为BPG的头部比HEVC的头部更小</li>
<li>支持4:2:2和4:2:0的色值设置</li>
<li><p>BPG可以用于硬件上支持HEVC编解码器</p>
<p>这种图片格式目前还没有被浏览器支持，需要js解码，但其优势非常明显。</p>
<p>另外还有mozjpg、sharpP的图片格式，由于目前仍在起步阶段，这里暂不介绍了，有兴趣的可以去跟进了解下。</p>
</li>
</ul>
</li>
</ul>
<h4 id="u4E8C_u3001_u524D_u7AEF_u7684_u56FE_u7247_u4F18_u5316_u65B9_u6848"><a href="#u4E8C_u3001_u524D_u7AEF_u7684_u56FE_u7247_u4F18_u5316_u65B9_u6848" class="headerlink" title="二、前端的图片优化方案"></a>二、前端的图片优化方案</h4><ol>
<li><p><strong>使用base64编码代替图片</strong><br> 场景：适用于图片大小小于2KB，页面上引用图片总数不多的情况<br> 原理：将图片转换为base64编码字符串inline到页面或css中<br> 优势：减少http的请求次数，并可以放到后台数据库中，只传输字符串，有较多的构建工具可以直接实现<br> 劣势：这种方法仅限于图片总数较少，而且图片大小小于2KB的情况。否则图片字符串会变得很长很长</p>
</li>
<li><p><strong>合并图片sprite(雪碧图)</strong><br> 场景：任何用到页面图片的场景<br> 原理：将多个页面上用到的背景图片合并成一个大的图片在页面中引用<br> 优势：可以有效的较少请求个数，而且，而不影响开发体验，使用构建插件可以做到对开发者透明。适用于页面图片多且丰富的场景。<br> 劣势：生成的图片体积较大，减少请求个数同时也增加了图片大小，不合理拆分将不利于并行加载</p>
</li>
<li><p><strong>使用css、svg、canvas或iconfont代替图片</strong></p>
<p> css代替图片<br> 场景：适用于移动端或较高级的浏览器，而且绘制的图案较为简单。<br> 原理：css方式可以用来绘制相对简单的团来代替图片，一般使用before或者after伪元素来丰富图案的复杂度。<br> 优势：具有实现简单，图片体积小的特点，可以实现简单的动态效果<br> 劣势：也受限于css的兼容性特点，绘制复杂图案困难</p>
<p> svg的描述和适用场景上文已说明。</p>
<p> canvas代替图片<br> 场景：需要高性能的图片或动画<br> 原理：适用html5的canvas元素绘制创建图片<br> 优势：整个就是画2D图形时，页面渲染性能比较高，页面渲染性能受图形复杂度影响小，性能只受图形的分辨率的影响，画出来的图形可以直接保存为 .png 或者 .jpg的图形，适合于画光栅图像或者不规则图形<br> 劣势：没有dom操作，必须依赖定时器，文字渲染性能差，不能添加描述(title属性什么的)，兼容性限制</p>
<p> iconfont是一种web字体来代替图片的解决方案：<br> 场景：代替页面上色彩单一的图片<br> 优势：兼容性好，应用广，目前使用也很广泛<br> 劣势：但是由于字体的颜色设置单一，只能用于代替颜色单一的图片，对于色彩复杂的图片，iconfont处理起来比较困难</p>
</li>
<li><p><strong>响应式图片</strong><br> 场景：不同终端对同一个图片需求不一样，可以根据终端加载不同的图片来节省没必要的流量<br> 原理：通过picture元素，picturefill或平台判断来为不同终端平台输出不同的图片<br> 优势：减少没必要的图片加载，灵活控制，慢速用户加载小图片不至于加载失败，移动端没必要加载大尺寸图片等，可以通过不同方式兼容所有浏览器<br> 劣势：无法避免图片的加载过程，图片本身没优化</p>
</li>
<li><p><strong>图片压缩</strong><br> 场景：在不得不加载图片的前提下，要进一步提升优化效果，只能通过有损或无损压缩来减少图片的大小。<br> 原理：对图片进行无损、有损压缩，转为压缩后图片来实现<br> 优势：减少图片加载流量，效果比较明显<br> 劣势：服务器和浏览器压力增大，而且服务器需要额外的服务支持</p>
</li>
<li><p><strong>更好的图片格式</strong><br> 场景：之前说到webp、bpg、sharpP等新图片格式具有更好的压缩比，可以使用这类新型的图片来代替原始图片<br> 原理：对图片格式转换，在画质可以接受的情况下达到更好的压缩比效果<br> 优势：减少图片加载流量，效果比较明显<br> 劣势：服务器和浏览器压力增大，而且服务器需要额外的服务支持，格式转换要考虑浏览器的兼容性</p>
</li>
</ol>
<h4 id="u4E09_u3001_u56FE_u7247_u538B_u7F29"><a href="#u4E09_u3001_u56FE_u7247_u538B_u7F29" class="headerlink" title="三、图片压缩"></a>三、图片压缩</h4><p>压缩图片方式比较多，例如下面的部分工具平台：</p>
<p>Kraken (Web)<br>主页： <a href="https://kraken.io/" target="_blank" rel="external">https://kraken.io/</a></p>
<p>智图<br>主页： <a href="http://zhitu.tencent.com/" target="_blank" rel="external">http://zhitu.tencent.com/</a><br>支持原图png转为jpeg和webp(目前不支持bpg)，并提供各种压缩比压缩，目前在tx内部广泛使用。</p>
<p>目前bpg格式图片也有部分公司在试用。这方面也可以尝试下。</p>
<h4 id="u56DB_u3001_u5C0F_u7ED3"><a href="#u56DB_u3001_u5C0F_u7ED3" class="headerlink" title="四、小结"></a>四、小结</h4><p>&emsp;&emsp;上面提供了web图片的一些格式特点和图片优化的可行方案，具体的场景需要考虑选择不同的方式来进行优化。当然常见的优化思路为：页面静态资源图片使用css，canvas，svg，iconfont，sprite，base64来优化，后台返回的数据资源图片则通过响应式、图片压缩来优化，同时尽可能考虑使用新的更高压缩比的图片来做图片转化。例如webp、bpg</p>
<p><a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/image-optimization?hl=zh-cn" target="_blank" rel="external">google image rearch 链接</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/11/15/ouvens.github.io/frontend-resource/2015-11-15-html-css-code-style/" itemprop="url">
                html与css编码规范
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-11-15T00:00:00+08:00" content="2015-11-15">
            2015-11-15
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/frontend-resource/" itemprop="url" rel="index">
                  <span itemprop="name">frontend-resource</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/11/15/ouvens.github.io/frontend-resource/2015-11-15-html-css-code-style/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/15/ouvens.github.io/frontend-resource/2015-11-15-html-css-code-style/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h3 id="1-__u89C4_u8303_u6982_u8FF0"><a href="#1-__u89C4_u8303_u6982_u8FF0" class="headerlink" title="1. 规范概述"></a>1. 规范概述</h3><p>规范的制定是我们长期以来对工作的积累与沉淀的产物，帮助我们更快、更好、更高效的完成繁重、复杂、多样化的任务，我们制作规范的主要目的在于：</p>
<ul>
<li>降低每个组员介入项目的门槛成本；</li>
<li>提高工作效率及协同开发的便捷性；</li>
<li>高度统一的代码风格；</li>
<li>提供一整套HTML、CSS解决方案，来帮助开发人员快速做出高质量的符合要求的页面；</li>
</ul>
<h3 id="2-__u57FA_u672C_u4FE1_u606F"><a href="#2-__u57FA_u672C_u4FE1_u606F" class="headerlink" title="2. 基本信息"></a>2. 基本信息</h3><table>
<thead>
<tr>
<th>规范名称</th>
<th>Cook</th>
</tr>
</thead>
<tbody>
<tr>
<td>制订日期</td>
<td>2013.12.18</td>
</tr>
<tr>
<td>当前版本</td>
<td>beta0.1</td>
</tr>
<tr>
<td>对规范进行初步定义</td>
<td>规范制定</td>
</tr>
<tr>
<td>最后更新</td>
<td>2014.12.19</td>
</tr>
</tbody>
</table>
<h3 id="3-__u6587_u6863_u76EE_u5F55_u7ED3_u6784"><a href="#3-__u6587_u6863_u76EE_u5F55_u7ED3_u6784" class="headerlink" title="3. 文档目录结构"></a>3. 文档目录结构</h3><p>待添加。</p>
<h3 id="4-__u901A_u7528_u7EA6_u5B9A"><a href="#4-__u901A_u7528_u7EA6_u5B9A" class="headerlink" title="4. 通用约定"></a>4. 通用约定</h3><h4 id="4-1__u5206_u79BB"><a href="#4-1__u5206_u79BB" class="headerlink" title="4.1 分离"></a>4.1 分离</h4><ul>
<li>结构（HTML）、表现（CSS）、行为分离（JavaScript）<br>将结构与表现、行为分离，保证它们之间的最小耦合，这对前期开发和后期维护都至关重要</li>
</ul>
<h4 id="4-2__u7F29_u8FDB"><a href="#4-2__u7F29_u8FDB" class="headerlink" title="4.2 缩进"></a>4.2 缩进</h4><ul>
<li>使用tab（4个空格宽度）来进行缩进，可以在IDE里进行设置</li>
</ul>
<h4 id="4-3__u7F16_u7801"><a href="#4-3__u7F16_u7801" class="headerlink" title="4.3 编码"></a>4.3 编码</h4><ul>
<li>以 UTF-8 无 BOM 编码作为页面格式；</li>
<li>在HTML中文档中用 <meta charset="utf-8"> 来指定编码；</li>
<li>不需要为CSS显示定义编码，因为它默认为utf-8；</li>
</ul>
<h4 id="4-4__u5C0F_u5199"><a href="#4-4__u5C0F_u5199" class="headerlink" title="4.4 小写"></a>4.4 小写</h4><ul>
<li>所有的HTML标签必须小写</li>
<li>所有的HTML属性必须小写</li>
<li>所有的样式名及规则必须小写</li>
</ul>
<h4 id="4-5__u6CE8_u91CA"><a href="#4-5__u6CE8_u91CA" class="headerlink" title="4.5 注释"></a>4.5 注释</h4><ul>
<li>尽可能的为你的代码写上注释。解释为什么要这样写，它是新鲜的方案还是解决了什么问题。</li>
</ul>
<h4 id="4-6__u5F85_u529E_u4E8B_u9879"><a href="#4-6__u5F85_u529E_u4E8B_u9879" class="headerlink" title="4.6 待办事项"></a>4.6 待办事项</h4><ul>
<li>用 TODO 标示待办事项和正在开发的条目</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- <span class="doctag">TODO:</span> 图文混排 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"g-imgtext"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">”1.png”</span> <span class="attribute">alt</span>=<span class="value">""</span>&gt;</span></span><br><span class="line"> ...</span><br><span class="line">/* TODO: 图文混排 comm: g-imgtext */</span><br><span class="line"></span><br><span class="line">.g-imgtext&#123;...&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-7__u884C_u5C3E_u7A7A_u683C"><a href="#4-7__u884C_u5C3E_u7A7A_u683C" class="headerlink" title="4.7 行尾空格"></a>4.7 行尾空格</h4><ul>
<li>删除行尾空格，这些空格没有必要存在</li>
</ul>
<h4 id="4-8__u4EE3_u7801_u6709_u6548_u6027"><a href="#4-8__u4EE3_u7801_u6709_u6548_u6027" class="headerlink" title="4.8 代码有效性"></a>4.8 代码有效性</h4><ul>
<li>使用 <a href="http://validator.w3.org/" target="_blank" rel="external">http://validator.w3.org/</a> 来验证你的HTML代码有效性；</li>
<li>使用 <a href="http://jigsaw.w3.org/css-validator/" target="_blank" rel="external">http://jigsaw.w3.org/css-validator/</a> 来验证你的CSS代码有效性；<br>代码验证不是最终目的，真的目的在于让开发者在经过多次的这种验证过程后，能够深刻理解到怎样的语法或写法是非标准和不推荐的，即使在某些场景下被迫要使用非标准写法，也可以做到心中有数</li>
</ul>
<h3 id="5-_HTML_u89C4_u8303"><a href="#5-_HTML_u89C4_u8303" class="headerlink" title="5. HTML规范"></a>5. HTML规范</h3><h4 id="5-1__u6587_u6863_u7C7B_u578B"><a href="#5-1__u6587_u6863_u7C7B_u578B" class="headerlink" title="5.1 文档类型"></a>5.1 文档类型</h4><ul>
<li><p>统一使用HTML5的标准文档类型：&lt;!doctype html&gt;<br>HTML5文档类型具备前后兼容的特质，并且易记易书写</p>
</li>
<li><p>在文档doctype申明之前，不允许加上任何非空字符<br>任何出现在doctype申明之前的字符都将使得你的HTML文档进入非标准模式</p>
</li>
<li><p>不允许添加<meta>属性强制改变文档模式<br>避免出现不可控的问题</p>
</li>
</ul>
<h4 id="5-2__u7701_u7565type_u5C5E_u6027"><a href="#5-2__u7701_u7565type_u5C5E_u6027" class="headerlink" title="5.2 省略type属性"></a>5.2 省略type属性</h4><ul>
<li>在调用CSS和JavaScript时，可以将type属性省略不写<br>不推荐：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">link</span> <span class="attribute">type</span>=<span class="value">"text/css"</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"base.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"base.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"base.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"base.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>因为HTML5在引入CSS时，默认type值为text/css；在引入JavaScript时，默认type值为text/javascript</p>
<h4 id="5-3__u7528_u53CC_u5F15_u53F7_u5305_u88F9_u5C5E_u6027_u503C"><a href="#5-3__u7528_u53CC_u5F15_u53F7_u5305_u88F9_u5C5E_u6027_u503C" class="headerlink" title="5.3 用双引号包裹属性值"></a>5.3 用双引号包裹属性值</h4><ul>
<li>所有的标签属性值必须要用双引号包裹，同时也不允许有的用双引号，有的用单引号的情况</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">http:</span>//<span class="attribute">www.qunar.com</span> <span class="attribute">class</span>=<span class="value">home</span>&gt;</span>首页<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://www.qunar.com"</span> <span class="attribute">class</span>=<span class="value">"home"</span>&gt;</span>首页<span class="tag">&lt;/<span class="title">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="5-4__u5C5E_u6027_u503C_u7701_u7565"><a href="#5-4__u5C5E_u6027_u503C_u7701_u7565" class="headerlink" title="5.4 属性值省略"></a>5.4 属性值省略</h4><ul>
<li>非必须属性值可以省略</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">readonly</span>=<span class="value">"readonly"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">disabled</span>=<span class="value">"disabled"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">readonly</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">disabled</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里的 readonly 和 disabled 属性的值是非必须的，可以省略不写，我们知道HTML5表单元素新增了很多类似的属性，如: required</p>
<h4 id="5-5__u5D4C_u5957"><a href="#5-5__u5D4C_u5957" class="headerlink" title="5.5 嵌套"></a>5.5 嵌套</h4><ul>
<li>所有元素必须正确嵌套，不允许交叉，不允许inline元素包含block元素，不允许类似在ul下出现除了li外的其它子元素等等<br>不推荐：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">span</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">h1</span>&gt;</span>这是一个块级h1元素<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">p</span>&gt;</span>这是一个块级p元素<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">ul</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">h3</span>&gt;</span>xx列表<span class="tag">&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">li</span>&gt;</span>asdasdsdasd<span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">li</span>&gt;</span>asdasdsdasd<span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">h1</span>&gt;</span>这是一个块级h1元素<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">p</span>&gt;</span>这是一个块级p元素<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">h3</span>&gt;</span>xx列表<span class="tag">&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">li</span>&gt;</span>asdasdsdasd<span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">li</span>&gt;</span>asdasdsdasd<span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>规则可参考：<a href="http://www.cs.tut.fi/~jkorpela/html/strict.html由于某些现实原因，在HTML5中对a元素做了一些变更，a元素除了可以包含inline元素外，也将可以包含block元素了。" target="_blank" rel="external">http://www.cs.tut.fi/~jkorpela/html/strict.html由于某些现实原因，在HTML5中对a元素做了一些变更，a元素除了可以包含inline元素外，也将可以包含block元素了。</a></p>
<h4 id="5-6__u6807_u7B7E_u95ED_u5408"><a href="#5-6__u6807_u7B7E_u95ED_u5408" class="headerlink" title="5.6 标签闭合"></a>5.6 标签闭合</h4><ul>
<li>非自闭合标记必须关闭</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">div</span>&gt;</span>balabala...</span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">div</span>&gt;</span>balabala...<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>虽然有些标记没有要求必须关闭，但是为了避免出错的几率，要求必须全部关闭，省去判断某标记是否需要关闭的时间</p>
<ul>
<li>自闭合标记无需关闭</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">base</span>&gt;</span> <span class="tag">&lt;<span class="title">br</span>&gt;</span> <span class="tag">&lt;<span class="title">col</span>&gt;</span> <span class="tag">&lt;<span class="title">embed</span>&gt;</span> <span class="tag">&lt;<span class="title">hr</span>&gt;</span> <span class="tag">&lt;<span class="title">img</span>&gt;</span> <span class="tag">&lt;<span class="title">input</span>&gt;</span> <span class="tag">&lt;<span class="title">link</span>&gt;</span> <span class="tag">&lt;<span class="title">meta</span>&gt;</span> <span class="tag">&lt;<span class="title">param</span>&gt;</span>...</span><br></pre></td></tr></table></figure>
<h4 id="5-7__u4F7F_u7528img_u7684alt_u5C5E_u6027"><a href="#5-7__u4F7F_u7528img_u7684alt_u5C5E_u6027" class="headerlink" title="5.7 使用img的alt属性"></a>5.7 使用img的alt属性</h4><ul>
<li>为img元素加上alt属性</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"banner.jpg"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"banner.jpg"</span> <span class="attribute">alt</span>=<span class="value">"520即将到来，爱就大声说出来"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>alt属性的内容为对该图片的简要描述，这对于盲人用户和图像损毁都非常有意义，即无障碍<br>对于纯粹的装饰性图片，alt属性值可以留空，如 alt=””</p>
<h4 id="5-8__u4F7F_u7528label_u7684for_u5C5E_u6027"><a href="#5-8__u4F7F_u7528label_u7684for_u5C5E_u6027" class="headerlink" title="5.8 使用label的for属性"></a>5.8 使用label的for属性</h4><ul>
<li>为表单元素label加上for属性</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"radio"</span> <span class="attribute">name</span>=<span class="value">"color"</span> <span class="attribute">value</span>=<span class="value">"0"</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">label</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"radio"</span> <span class="attribute">name</span>=<span class="value">"color"</span> <span class="attribute">value</span>=<span class="value">"1"</span>&gt;</span>粉色<span class="tag">&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"blue"</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"radio"</span> <span class="attribute">id</span>=<span class="value">"blue"</span> <span class="attribute">name</span>=<span class="value">"color"</span> <span class="attribute">value</span>=<span class="value">"0"</span>&gt;</span>蓝色<span class="tag">&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"pink"</span>&gt;</span><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"radio"</span> <span class="attribute">id</span>=<span class="value">"pink"</span> <span class="attribute">name</span>=<span class="value">"color"</span> <span class="attribute">value</span>=<span class="value">"1"</span>&gt;</span>粉色<span class="tag">&lt;/<span class="title">label</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>for属性能让点击label标签的时候，同时focus到对应的 input 和 textarea上，增加响应区域</p>
<h4 id="5-9__u6309_u6A21_u5757_u6DFB_u52A0_u6CE8_u91CA"><a href="#5-9__u6309_u6A21_u5757_u6DFB_u52A0_u6CE8_u91CA" class="headerlink" title="5.9 按模块添加注释"></a>5.9 按模块添加注释</h4><ul>
<li>在每个模块开始和结束的地方添加注释</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- comment --&gt;</span><br><span class="line">注释内容左右两边保留和注释符号有1个空格位</span><br><span class="line">在注释内容内不允许再出现中划线“-”，某些浏览器会报错</span><br><span class="line"></span><br><span class="line">&lt;!-- 新闻列表模块 --&gt;</span><br><span class="line">&lt;div id="news" class="g-mod"</span><br><span class="line">...</span><br><span class="line">&lt;!-- /新闻列表模块 --&gt;</span><br><span class="line">&lt;!-- 排行榜模块 --&gt;</span><br><span class="line">&lt;div id="topic" class="g-mod"</span><br><span class="line">...</span><br><span class="line">&lt;!-- /排行榜模块 --&gt;</span><br></pre></td></tr></table></figure>
<h4 id="5-10__u683C_u5F0F"><a href="#5-10__u683C_u5F0F" class="headerlink" title="5.10 格式"></a>5.10 格式</h4><ul>
<li>将每个块元素、列表元素或表格元素都放在新行</li>
<li>Inline元素视情况换行，以长度不超过编辑器一屏为宜</li>
<li>每个子元素都需要相对其父级缩进</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">div</span>&gt;</span><span class="tag">&lt;<span class="title">h1</span>&gt;</span>asdas<span class="tag">&lt;/<span class="title">h1</span>&gt;</span><span class="tag">&lt;<span class="title">p</span>&gt;</span>dff<span class="tag">&lt;<span class="title">em</span>&gt;</span>asd<span class="tag">&lt;/<span class="title">em</span>&gt;</span>asda<span class="tag">&lt;<span class="title">span</span>&gt;</span>sds<span class="tag">&lt;/<span class="title">span</span>&gt;</span>dasdasd<span class="tag">&lt;/<span class="title">p</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">&lt;<span class="title">div</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">h1</span>&gt;</span>asdas<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">p</span>&gt;</span>dff<span class="tag">&lt;<span class="title">em</span>&gt;</span>asd<span class="tag">&lt;/<span class="title">em</span>&gt;</span>asda<span class="tag">&lt;<span class="title">span</span>&gt;</span>sds<span class="tag">&lt;/<span class="title">span</span>&gt;</span>dasdasd<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="5-11__u8BED_u4E49_u5316_u6807_u7B7E"><a href="#5-11__u8BED_u4E49_u5316_u6807_u7B7E" class="headerlink" title="5.11 语义化标签"></a>5.11 语义化标签</h4><ul>
<li>在合适的场景选择语义合适的标签</li>
<li>禁止使用被废弃的用于表现的标签，如 center, font等</li>
<li><p>部分在XHTML1中被废弃的标签，在HTML5中被重新赋予了新的语义，在选用时请先弄清其语义，如:b, i, u等</p>
</li>
<li><p>元素据标记<br>head, title, base, link, meta, style</p>
</li>
<li><p>章节标签<br>html, body, section, nav, article, aside, h1, h2, h3, h4, h5, h6, hgroup, header, footer, address</p>
</li>
<li><p>脚本标记<br>script, noscript</p>
</li>
<li><p>分组内容标记<br>p, hr, pre, blockquote, ol, ul, li, dl, dt, dd, figure, figcaption, div</p>
</li>
</ul>
<ul>
<li><p>文本标签<br>a, em, strong, small, s, cite, q, dfn, abbr, time, code, var, samp, kbd, sub, sup, i, b, u, mark, ruby, rt, rp, bdi, bdo, span, br, wbr, ins, del</p>
</li>
<li><p>媒体标签<br>img, iframe, embed, object, param, video, audio, source, track, canvas, map, area</p>
</li>
<li><p>互动标签<br>details, summary, command, menu</p>
</li>
<li><p>表单标签<br>form, fieldset, legend, label, input, button, select, datalist, optgroup, option, textarea, keygen, output, progress, meter</p>
</li>
<li><p>表格标签<br>table, caption, colgroup, col, thead, tbody, tfoot, tr, td, th</p>
</li>
<li><p>参考文档：<br><a href="http://www.w3.org/TR/html5/" target="_blank" rel="external">http://www.w3.org/TR/html5/</a><br><a href="http://dev.w3.org/html5/markup/elements.html" target="_blank" rel="external">http://dev.w3.org/html5/markup/elements.html</a></p>
</li>
</ul>
<h4 id="5-12__u6587_u6863_u6A21_u677F"><a href="#5-12__u6587_u6863_u6A21_u677F" class="headerlink" title="5.12 文档模板"></a>5.12 文档模板</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"zh-cn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">title</span>&gt;</span>网站项目名称-网站名称<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">link</span> <span class="attribute">href</span>=<span class="value">"*.css"</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">”doc”</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">header</span> <span class="attribute">id</span>=<span class="value">"hd"</span>&gt;</span></span><br><span class="line">　　　　　　头部诸模块</span><br><span class="line">　　　<span class="tag">&lt;/<span class="title">header</span> &gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"bd"</span>&gt;</span></span><br><span class="line">　　　　　　主体部分诸模块</span><br><span class="line">　　　<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">footer</span> <span class="attribute">id</span>=<span class="value">"ft"</span>&gt;</span></span><br><span class="line">　　　　　　底部诸模块</span><br><span class="line">　　　<span class="tag">&lt;/<span class="title">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"*.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>所有的项目页面都可以直接使用上述的标准文档模板，并根据实际情况做 “加法” ，诸如meta的description, keywords之类，其中#doc级别不是必须的，视情况加减</p>
<h4 id="5-13__u6A21_u5757_u6A21_u677F"><a href="#5-13__u6A21_u5757_u6A21_u677F" class="headerlink" title="5.13 模块模板"></a>5.13 模块模板</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">section</span> <span class="attribute">class</span>=<span class="value">"m-xxx g-mod"</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">header</span> <span class="attribute">class</span>=<span class="value">"m-xxx-hd"</span>&gt;</span></span><br><span class="line">　　　　　　头部区域</span><br><span class="line">　　　<span class="tag">&lt;/<span class="title">header</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"m-xxx-bd"</span>&gt;</span></span><br><span class="line">　　　　　　模块正文</span><br><span class="line">　　　<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">　　　<span class="tag">&lt;<span class="title">footer</span> <span class="attribute">class</span>=<span class="value">"m-xxx-ft"</span>&gt;</span></span><br><span class="line">　　　　　　底部区域</span><br><span class="line">　　　<span class="tag">&lt;/<span class="title">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">section</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>所有的模块默认都是上面这种固有结构，特殊情况可视场景而变，换句话说，有的时候你的某个模块可能会是一个aside。</p>
<h3 id="6-_CSS_u89C4_u8303"><a href="#6-_CSS_u89C4_u8303" class="headerlink" title="6. CSS规范"></a>6. CSS规范</h3><h4 id="6-1_CSS_u6587_u4EF6_u89C4_u8303"><a href="#6-1_CSS_u6587_u4EF6_u89C4_u8303" class="headerlink" title="6.1 CSS文件规范"></a>6.1 CSS文件规范</h4><ul>
<li>一律使用link的方式调用外部样式<br>使用fekit时，会处理样式内部的@import依赖关系，同时会合并文件，所以这里不反对使用在css文件内部使用@import</li>
</ul>
<h4 id="6-2__u6837_u5F0F_u7684_u547D_u540D_u7EA6_u5B9A"><a href="#6-2__u6837_u5F0F_u7684_u547D_u540D_u7EA6_u5B9A" class="headerlink" title="6.2 样式的命名约定"></a>6.2 样式的命名约定</h4><p><strong>6.2.1 命名组成元素</strong></p>
<ul>
<li>命名必须由单词、中划线 ① 组成。例如：.detail, .news-list, #topic, and etc…</li>
<li>不推荐使用拼音来作为样式名，尤其是缩写的拼音、拼音与英文的混合</li>
<li>所有命名都使用小写<br>①我们使用中划线 “-” 作为连接字符，而不是下划线 “_”。<br>我们知道2种方式都有不少支持者，但 “-“ 能让你少按一次shift键，并且更符合CSS原生语法，所以我们只选一种目前业内普遍使用的方式</li>
</ul>
<p><strong>6.2.2 前缀规范</strong></p>
<table>
<thead>
<tr>
<th>前缀</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>g-</td>
<td>全局通用样式命名，前缀g全称为global，一旦修改将影响全站样式</td>
<td>g-mod</td>
</tr>
<tr>
<td>m-</td>
<td>模块命名方式</td>
<td>m-detail</td>
</tr>
<tr>
<td>ui-</td>
<td>组件命名方式</td>
<td>ui-selector</td>
</tr>
<tr>
<td>J-</td>
<td>所有用于纯交互的命名，不涉及任何样式规则。JSer拥有全部定义权限</td>
<td>J-switch</td>
</tr>
</tbody>
</table>
<p>不允许出现以类似：.info, .current, .news 开头的选择器，比如：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.info&#123;sRules;&#125;</span><br></pre></td></tr></table></figure>
<p>因为这样将给我们带来不可预知的管理麻烦以及沉重的历史包袱。你永远也不会知道哪些样式名已经被用掉了，如果你是一个新人，你可能会遭遇，你每定义个样式名，都有同名的样式已存在，然后你只能是换样式名或者覆盖规则。所以我们推荐这样写：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.m-xxx .info&#123;sRules;&#125;</span><br></pre></td></tr></table></figure>
<p>所有的选择器必须是以 g-, m-, ui- 等有前缀的选择符开头的，意思就是说所有的规则都必须在某个相对的作用域下才生效，尽可能减少全局污染。<br>J- 这种级别的className完全交由JSer自定义，但是命名的规则也可以保持跟重构一致，比如说不能使用拼音之类的</p>
<p><strong>6.2.3 命名单词的选择规范</strong></p>
<ul>
<li>不以表现来命名，而是根据内容来命名。比如：left, right, center, red, black这种以表现来定命名，不允许出现；</li>
<li>推荐使用功能和内容相关词汇的命名，如：navigation, news, type, search<br>(待大家总结)</li>
</ul>
<p><strong>6.2.4 样式命名缩写规范</strong></p>
<p>原则：缩写后还能较为清晰保持原单词所能表述的意思，如：</p>
<p>navigation   =&gt;  nav<br>header       =&gt;  hd<br>information  =&gt;  info</p>
<p><strong>6.2.5 复用与重写规范</strong></p>
<p>参见模块化设计</p>
<p><strong>6.2.6 id与className的使用规范</strong></p>
<ul>
<li>id只可能出现在document layout级别上，意思就是说页面工程师几乎没有写id的场景，除了layout搭建者外</li>
</ul>
<h4 id="6-3__u4E66_u5199_u98CE_u683C_u4E0E_u6392_u7248_u89C4_u8303"><a href="#6-3__u4E66_u5199_u98CE_u683C_u4E0E_u6392_u7248_u89C4_u8303" class="headerlink" title="6.3 书写风格与排版规范"></a>6.3 书写风格与排版规范</h4><p><strong>6.3.1 视觉封装</strong></p>
<ul>
<li>CSS代码书写不分行</li>
<li>不要以缩进的方式来体现层级关系</li>
</ul>
<p>不推荐：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.g-box&#123; sRules; &#125;</span><br><span class="line">　　　.g-box-hd .xx&#123; sRules; &#125;</span><br><span class="line">　　　　　　.g-box-hd .xx .aa&#123; sRules; &#125;</span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.g-box&#123; sRules; &#125;</span><br><span class="line">.g-box-hd .xx&#123; sRules; &#125;</span><br><span class="line">.g-box-hd .xx .aa&#123; sRules; &#125;</span><br></pre></td></tr></table></figure>
<p>这些都是为了达到简易视觉封装和一致性，让肉眼可以迅速以开头选择器作为检索的流从而主观识别区块</p>
<p><strong>6.3.2 规则与分号</strong></p>
<p>*每条规则结束后都必须加上分号</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">margin</span>:<span class="value"><span class="number">0</span></span></span>;<span class="rule"><span class="attribute">padding</span>:<span class="value"><span class="number">0</span></span></span>;<span class="rule"><span class="attribute">font-size</span>:<span class="value"><span class="number">14px</span></span></span></span>&#125;</span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">margin</span>:<span class="value"><span class="number">0</span></span></span>;<span class="rule"><span class="attribute">padding</span>:<span class="value"><span class="number">0</span></span></span>;<span class="rule"><span class="attribute">font-size</span>:<span class="value"><span class="number">14px</span></span></span>;&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>6.3.3 0与单位</strong></p>
<ul>
<li>如果属性值为0，则不需要为0加单位</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">margin</span>:<span class="value"><span class="number">0px</span></span></span>;<span class="rule"><span class="attribute">padding</span>:<span class="value"><span class="number">0px</span></span></span>;&#125;</span></span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">margin</span>:<span class="value"><span class="number">0</span></span></span>;<span class="rule"><span class="attribute">padding</span>:<span class="value"><span class="number">0</span></span></span>;&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>6.3.4 0与小数</strong></p>
<ul>
<li>如果是0开始的小数，前面的0可以省略不写</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">opacity</span>:<span class="value"><span class="number">0.6</span></span></span>;<span class="rule"><span class="attribute">text-shadow</span>:<span class="value"><span class="number">1px</span> <span class="number">1px</span> <span class="number">5px</span> <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.5</span>)</span></span>;&#125;</span></span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">opacity</span>:<span class="value">.<span class="number">6</span></span></span>;<span class="rule"><span class="attribute">text-shadow</span>:<span class="value"><span class="number">1px</span> <span class="number">1px</span> <span class="number">5px</span> <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">5</span>)</span></span>;&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>6.3.5 去掉uri中引用资源的引号</strong></p>
<ul>
<li>不要在url()里对引用资源加引号</li>
</ul>
<p>不推荐：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">background-image</span>:<span class="value"><span class="function">url</span>(<span class="string">"sprites.png"</span>)</span></span>;&#125;</span></span><br><span class="line"><span class="at_rule">@<span class="keyword">import</span> <span class="function">url</span>(<span class="string">"global.css"</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">background-image</span>:<span class="value"><span class="function">url</span>(sprites.png)</span></span>;&#125;</span></span><br><span class="line"><span class="at_rule">@<span class="keyword">import</span> <span class="function">url</span>(global.css)</span>;</span><br></pre></td></tr></table></figure>
<p>6.3.6 HEX颜色值写法</p>
<ul>
<li>将所有的颜色值小写</li>
<li>可以缩写的缩写至3位</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">不推荐：</span><br><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">background-color</span>:<span class="value"><span class="hexcolor">#FF8000</span></span></span>;&#125;</span></span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"><span class="tag">body</span><span class="rules">&#123;<span class="rule"><span class="attribute">background-color</span>:<span class="value"><span class="hexcolor">#f00</span></span></span>;&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="6-4__u6837_u5F0F_u89C4_u5219_u4E66_u5199_u987A_u5E8F"><a href="#6-4__u6837_u5F0F_u89C4_u5219_u4E66_u5199_u987A_u5E8F" class="headerlink" title="6.4 样式规则书写顺序"></a>6.4 样式规则书写顺序</h4><ul>
<li>遵循先布局后内容的顺序。</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.g-box</span><span class="rules">&#123;</span><br><span class="line">　　　<span class="rule"><span class="attribute">display</span>:<span class="value">block</span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">float</span>:<span class="value">left</span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">width</span>:<span class="value"><span class="number">500px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">height</span>:<span class="value"><span class="number">200px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">margin</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">padding</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">border</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">background</span>:<span class="value"><span class="hexcolor">#aaa</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">color</span>:<span class="value"><span class="hexcolor">#000</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">font</span>:<span class="value"><span class="number">14px</span>/<span class="number">1.5</span> sans-serif</span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这个应该好理解，比如优先布局，我们知道布局属性有 display, float, overflow 等等；内容次之，比如 color, font, text-align 之类。</p>
<ul>
<li>组概念。<br>拿上例的代码来说，如果我们还需要进行定位及堆叠，规则我们可以改成如下：</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.g-box</span><span class="rules">&#123;</span><br><span class="line">　　　<span class="rule"><span class="attribute">display</span>:<span class="value">block</span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">position</span>:<span class="value">relative</span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">z-index</span>:<span class="value"><span class="number">2</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">top</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">left</span>:<span class="value"><span class="number">100px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">float</span>:<span class="value">left</span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">width</span>:<span class="value"><span class="number">500px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">height</span>:<span class="value"><span class="number">200px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">margin</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">padding</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">border</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">background</span>:<span class="value"><span class="hexcolor">#aaa</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">color</span>:<span class="value"><span class="hexcolor">#000</span></span></span>;</span><br><span class="line">　　　<span class="rule"><span class="attribute">font</span>:<span class="value"><span class="number">14px</span>/<span class="number">1.5</span> sans-serif</span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>从代码中可以看到，我们直接将z-index, top, left 紧跟在 position 之后，因为这几个属性其实是一组的，如果去掉position，则后3条属性规则都将失效。</p>
<ul>
<li>私有属性在前标准属性在后</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.g-box</span><span class="rules">&#123;</span><br><span class="line">　　　<span class="rule"><span class="attribute">-webkit-box-shadow</span>:<span class="value"><span class="number">1px</span> <span class="number">1px</span> <span class="number">5px</span> <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">5</span>)</span></span>;</span><br><span class="line">　　　   <span class="rule"><span class="attribute">-moz-box-shadow</span>:<span class="value"><span class="number">1px</span> <span class="number">1px</span> <span class="number">5px</span> <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">5</span>)</span></span>;</span><br><span class="line">　　　    <span class="rule"><span class="attribute">-ms-box-shadow</span>:<span class="value"><span class="number">1px</span> <span class="number">1px</span> <span class="number">5px</span> <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">5</span>)</span></span>;</span><br><span class="line">　　　     <span class="rule"><span class="attribute">-o-box-shadow</span>:<span class="value"><span class="number">1px</span> <span class="number">1px</span> <span class="number">5px</span> <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">5</span>)</span></span>;</span><br><span class="line">　　　        <span class="rule"><span class="attribute">box-shadow</span>:<span class="value"><span class="number">1px</span> <span class="number">1px</span> <span class="number">5px</span> <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">5</span>)</span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>当有一天你的浏览器升级后，可能不再支持私有写法，那么这时写在后面的标准写法将生效，避免无法向后兼容的情况发生。</p>
<h4 id="6-5__u6CE8_u91CA_u89C4_u8303"><a href="#6-5__u6CE8_u91CA_u89C4_u8303" class="headerlink" title="6.5 注释规范"></a>6.5 注释规范</h4><ul>
<li>保持注释内容与星号之间有一个空格的距离</li>
</ul>
<p><strong>6.5.1 普通注释（单行）</strong></p>
<p>/<em> 普通注释 </em>/</p>
<p><strong>6.5.2 区块注释</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * 模块：m-detail</span><br><span class="line"> * author: joy.du</span><br><span class="line"> * edit:   2013.12.19</span><br><span class="line"> */</span></span><br></pre></td></tr></table></figure>
<p>有特殊作用的规则一定要有注释说明<br>应用了高级技巧的地方一定要注释说明</p>
<h4 id="6-6_hack_u89C4_u8303"><a href="#6-6_hack_u89C4_u8303" class="headerlink" title="6.6 hack规范"></a>6.6 hack规范</h4><ul>
<li>尽可能的减少对Hack的使用和依赖，如果在项目中对Hack的使用太多太复杂，对项目的维护将是一个巨大的挑战；</li>
<li>使用其它的解决方案代替Hack思路；</li>
<li>如果非Hack不可，选择稳定且常用并易于理解的；</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.test&#123;</span><br><span class="line">    color:#000;       /* For all */</span><br><span class="line">    color:#111\9;     /* For all IE */</span><br><span class="line">    color:#222\0;     /* For IE8 and later, Opera without Webkit */</span><br><span class="line">    color:#333\9\0;   /* For IE8 and later */</span><br><span class="line">    color:#444\0/;    /* For IE8 and later */</span><br><span class="line">    [;color:#555;];   /* For Webkit, IE7 and earlier */</span><br><span class="line">    *color:#666;      /* For IE7 and earlier */</span><br><span class="line">    _color:#777;      /* For IE6 and earlier */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>严谨且长期的项目，针对IE可以使用条件注释作为预留Hack或者在当前使用<br>IE条件注释语法：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--[if &lt;keywords&gt;? IE &lt;version&gt;?]&gt;</span><br><span class="line">&lt;link rel=”stylesheet” href=”*.css” /&gt;</span><br><span class="line">&lt;![endif]--&gt;</span></span><br></pre></td></tr></table></figure>
<p>语法说明：</p>
<p><keywords><br>if条件共包含6种选择方式：是否、大于、大于或等于、小于、小于或等于、非指定版本<br>是否：指定是否IE或IE某个版本。关键字：空<br>大于：选择大于指定版本的IE版本。关键字：gt（greater than）<br>大于或等于：选择大于或等于指定版本的IE版本。关键字：gte（greater than or equal）<br>小于：选择小于指定版本的IE版本。关键字：lt（less than）<br>小于或等于：选择小于或等于指定版本的IE版本。关键字：lte（less than or equal）<br>非指定版本：选择除指定版本外的所有IE版本。关键字：!</keywords></p>
<p><version><br>目前的常用IE版本为6.0及以上，推荐酌情忽略低版本，把精力花在为使用高级浏览器的用户提供更好的体验上，另从IE10开始已无此特性</version></p>
<h4 id="6-7__u907F_u514D_u7C7B_u578B_u9009_u62E9_u5668"><a href="#6-7__u907F_u514D_u7C7B_u578B_u9009_u62E9_u5668" class="headerlink" title="6.7 避免类型选择器"></a>6.7 避免类型选择器</h4><ul>
<li>避免出现标签名与ID或class组合的选择器</li>
<li>太多这种写法会让你的CSS效率变得糟糕<br>不推荐：</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">div#doc&#123; sRules; &#125;</span><br><span class="line">li.first&#123; sRules; &#125;</span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#doc&#123; sRules; &#125;</span><br><span class="line">.first&#123; sRules; &#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-8__u5C5E_u6027_u7F29_u5199_u4E0E_u5206_u62C6"><a href="#6-8__u5C5E_u6027_u7F29_u5199_u4E0E_u5206_u62C6" class="headerlink" title="6.8 属性缩写与分拆"></a>6.8 属性缩写与分拆</h4><ul>
<li>无继承关系时，使用缩写</li>
<li>存在继承关系时，使用分拆方式</li>
<li>根据规则条数选择缩写和拆分</li>
</ul>
<p><strong>6.8.1 无继承关系时，使用缩写</strong></p>
<p>不推荐：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">body</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">margin-top</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">margin-right</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">margin-bottom</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">margin-left</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">body</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">margin</span>:<span class="value"><span class="number">10px</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>6.8.2 存在继承关系时，使用分拆方式</strong></p>
<p>不推荐：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.m-detail</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">font</span>:<span class="value">blod <span class="number">12px</span>/<span class="number">1.5</span> arial,sans-serif</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="class">.m-detail</span> <span class="class">.info</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">font</span>:<span class="value">normal <span class="number">14px</span>/<span class="number">1.5</span> arial,sans-serif</span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.m-detail</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">font</span>:<span class="value">blod <span class="number">12px</span>/<span class="number">1.5</span> arial,sans-serif</span></span>;</span><br><span class="line">&#125;</span></span><br><span class="line"><span class="class">.m-detail</span> <span class="class">.info</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">font-weight</span>:<span class="value">normal</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">font-size</span>:<span class="value"><span class="number">14px</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>在存在继承关系的情况下，只将需要变更的属性重定义，不进行缩写，避免不需要的重写的属性被覆盖定义</p>
<p><strong>6.8.3 根据规则条数选择缩写和拆分</strong></p>
<p>不推荐：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.m-detail</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">border-width</span>:<span class="value"><span class="number">1px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">border-style</span>:<span class="value">solid</span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">border-color</span>:<span class="value"><span class="hexcolor">#000</span> <span class="hexcolor">#000</span> <span class="hexcolor">#f00</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>推荐：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.m-detail</span><span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">border</span>:<span class="value"><span class="number">1px</span> solid <span class="hexcolor">#000</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">border-bottom-color</span>:<span class="value"><span class="hexcolor">#f00</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="7-__u7ED3_u8BED"><a href="#7-__u7ED3_u8BED" class="headerlink" title="7. 结语"></a>7. 结语</h3><p>坚持一致性的原则。<br>一个团队的代码风格如果统一了，首先可以培养良好的协同和编码习惯，其次可以减少无谓的思考，再次可以提升代码质量和可维护性。<br>统一的代码风格，团队内部阅读或编辑代码，将会变得非常轻松，因为组员都用一致思维环境。</p>
<p>待修改完善</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/11/06/ouvens.github.io/frontend-css/2014-11-06-css-learning-list/" itemprop="url">
                css学习资源汇总
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-11-06T00:00:00+08:00" content="2015-11-06">
            2015-11-06
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/frontend-css/" itemprop="url" rel="index">
                  <span itemprop="name">frontend-css</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2015/11/06/ouvens.github.io/frontend-css/2014-11-06-css-learning-list/#comments" itemprop="discussionUrl">
              <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/06/ouvens.github.io/frontend-css/2014-11-06-css-learning-list/" itemprop="commentsCount"></span>
            </a>
          </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="css_reset"><a href="#css_reset" class="headerlink" title="css reset"></a>css reset</h2><p>目前有两种reset，一种是属于修正式的reset，这个以<a href="http://necolas.github.io/normalize.css/" target="_blank" rel="external">normalize.css</a>为代表；另一种就是我们常用的清零式reset如最简单的<code>*{margin:0;padding:0;}</code>，目前各个框架都是先以normalize为基础，然后实现清零。<br>清零之外，我们会给html或body添加些font属性或背景，也会添加一些基础的类，方便使用，如<code>clearfix</code></p>
<p><a href="http://www.w3cplus.com/solution/iebug/iebug.html" target="_blank" rel="external">ie bug集合</a><br>关于如何给各种浏览器打bug，可查询：<br><a href="http://browserhacks.com/" target="_blank" rel="external">browser hacks</a><br>因为里面有很多问题都是ie6/7的，所以大家多少都应该了解过，应该没什么问题，如果问题比较多的话，我再考虑ppt分享下。<br><a href="http://www.qianduan.net/ie6u002639s-bug-amended-10-tips.html" target="_blank" rel="external">http://www.qianduan.net/ie6u002639s-bug-amended-10-tips.html</a></p>
<p>清除浮动包括清除子元素的浮动和清除上级元素的浮动，其中清除上级元素的浮动，只需设置clear为both（或left，right）就可以了，而清除子元素的浮动则可以用空标签、clearfix或overflow。因清除上级元素的浮动比较简单，而空标签法清除子元素浮动会增加额外标签，所以推荐使用clearfix和overflow。</p>
<p>除此之外，<code>display:inline-block;</code>也可以清除子元素浮动。</p>
<p><a href="http://www.w3cplus.com/solution/clearfloat/clearfloat.html" target="_blank" rel="external">清除浮动解决方案</a></p>
<h3 id="PostCSS"><a href="#PostCSS" class="headerlink" title="PostCSS"></a>PostCSS</h3><p><a href="https://github.com/postcss/postcss" target="_blank" rel="external">https://github.com/postcss/postcss</a><br>根据caniuse（<a href="https://github.com/postcss/postcss" target="_blank" rel="external">https://github.com/postcss/postcss</a> ）的数据，自动生存浏览器前缀<br>grunt-autoprefixer: <a href="https://www.npmjs.com/package/grunt-autoprefixer" target="_blank" rel="external">https://www.npmjs.com/package/grunt-autoprefixer</a><br>gulp-autoprefixer: <a href="https://www.npmjs.com/package/gulp-autoprefixer" target="_blank" rel="external">https://www.npmjs.com/package/gulp-autoprefixer</a></p>
<h3 id="flex_u5E94_u7528_u573A_u666Fdemo_u89C1_u9644_u4EF6"><a href="#flex_u5E94_u7528_u573A_u666Fdemo_u89C1_u9644_u4EF6" class="headerlink" title="flex应用场景demo见附件"></a>flex应用场景demo见附件</h3><p><a href="http://www.w3cplus.com/blog/666.html" target="_blank" rel="external">深入了解flex</a></p>
<p>###<br>图文混排解决方案](<a href="http://www.w3cplus.com/solution/imagetextmix/imagetextmix.html" target="_blank" rel="external">http://www.w3cplus.com/solution/imagetextmix/imagetextmix.html</a>)</p>
<p>除上述方法外，还有昨天发的flex方法</p>
<h3 id="css3__u5B66_u4E60_u8D44_u6E90"><a href="#css3__u5B66_u4E60_u8D44_u6E90" class="headerlink" title="css3 学习资源"></a>css3 学习资源</h3><p>先放个资源集合，以后再整理个单个属性的关键点：</p>
<ul>
<li><a href="http://css3files.com/" target="_blank" rel="external">css3 files</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Reference" target="_blank" rel="external">MDN CSS reference</a></li>
<li><a href="http://www.css3maker.com/" target="_blank" rel="external">css3 maker</a></li>
</ul>
<h3 id="u5217_u8868_u7C7B_u89E3_u51B3_u65B9_u6848"><a href="#u5217_u8868_u7C7B_u89E3_u51B3_u65B9_u6848" class="headerlink" title="列表类解决方案"></a>列表类解决方案</h3><p><a href="http://www.w3cplus.com/solution/itemlist/itemlist.html" target="_blank" rel="external">http://www.w3cplus.com/solution/itemlist/itemlist.html</a><br>同样，这个也可以用flex来解决</p>
<h3 id="u5173_u4E8Ecss_u7684class_u547D_u540D"><a href="#u5173_u4E8Ecss_u7684class_u547D_u540D" class="headerlink" title="关于css的class命名"></a>关于css的class命名</h3><ul>
<li>BEM方式，这个大家都知道了</li>
<li><a href="http://jiongks.name/blog/naming-css-stuff-is-really-hard/" target="_blank" rel="external">CSS命名神马的真心难</a></li>
<li><a href="http://mrthink.net/css-tips-oopcoding/" target="_blank" rel="external">原子类class</a></li>
<li><a href="http://www.cnblogs.com/limingxi/p/3710600.html" target="_blank" rel="external">base基础类的那些事儿</a></li>
<li><a href="http://nec.netease.com/standard/css-sort.html" target="_blank" rel="external">分类形式class命名</a></li>
</ul>
<p>1、某些移动端的浏览器不支持<code>:checked ~ .ele</code>，但是支持<code>:checked + .ele</code></p>
<h2 id="border-radius"><a href="#border-radius" class="headerlink" title="border-radius"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/border-radius" target="_blank" rel="external">border-radius</a></h2><p>1、一般来说我们给的圆角弧度都是圆形的，如果需要弧度为椭圆的，则使用<code>/</code>分割x轴的半径和y轴的半径如：<code>border-radius: 18px / 13px</code></p>
<p>2、在高级浏览器的父元素设置圆角再加上<code>overflow:hidden</code>，则子元素设置的背景是不会溢出的，圆角表现良好。但是在部分低端浏览器（如安卓浏览器，uc浏览器等）则不行，这就还得为子元素也设圆角</p>
<p>3、某些老版本的浏览器img图片不支持border-radius</p>
<p>4、ie9如使用滤镜模拟渐变背景，颜色将会溢出，设置的圆角</p>
<h2 id="box-shadow"><a href="#box-shadow" class="headerlink" title="box-shadow"></a><a href="http://css-tricks.com/snippets/css/css-box-shadow/" target="_blank" rel="external">box-shadow</a></h2><p>1、内阴影使用关键词<code>inset</code></p>
<p>2、多值的时候第一个值的层级最高</p>
<p>3、单边shadow可以使用spread值来模拟，详见<a href="http://conceptboard.github.io/box-shadow-spread-examples/" target="_blank" rel="external">Use spread to manipulate the box-shadow</a></p>
<p>4、与下面的伪类结合，可以生存超强阴影，详见<a href="http://www.w3cplus.com/solution/css3box/css3box.html" target="_blank" rel="external">box-shadow阴影</a></p>
<h2 id="u4F2A_u5143_u7D20before_u548Cafter"><a href="#u4F2A_u5143_u7D20before_u548Cafter" class="headerlink" title="伪元素before和after"></a><a href="http://www.w3cplus.com/solution/css3content/css3content.html" target="_blank" rel="external">伪元素before和after</a></h2><p>1、css3中为了区分伪元素和伪类，规定伪元素使用<code>::</code>，而伪类则使用<code>:</code>，但是css2.1是不分的，一律采用<code>:</code>。所以对于before和after伪元素如果只考虑移动端的话最好写成<code>::before</code>,<code>::after</code>，而如果还要考虑pc的ie8的话，则写成<code>:before</code>，<code>:after</code></p>
<h2 id="u6587_u5B57_u7279_u6548"><a href="#u6587_u5B57_u7279_u6548" class="headerlink" title="文字特效"></a>文字特效</h2><p>1、<a href="http://www.w3cplus.com/solution/css3text/css3text.html" target="_blank" rel="external">text-shadow文字阴影</a></p>
<p>2、<a href="/">@font-face icon</a></p>
<p>2、<a href="http://font-spider.org/" target="_blank" rel="external">中文@font-face不是梦</a></p>
<p>3、<a href="http://viget.com/inspire/easy-textures-with-css-masks?utm_source=html5weekly&amp;utm_medium=email" target="_blank" rel="external">使用mask属性美化文字</a></p>
<h2 id="color"><a href="#color" class="headerlink" title="color"></a>color</h2><p>1、rgba，根据alpha的值设置透明度<br>2、opacity设置的透明度是整体的透明度，包括里面所有的子元素，而且子元素不可覆写。除z-index外，设置opacity也会影响元素的层级<br>3、如需要设置颜色的透明度，可使用rgba，如果是做动画的渐隐则选择opacity</p>
<h2 id="u5355_u4F4D"><a href="#u5355_u4F4D" class="headerlink" title="单位"></a>单位</h2><p>1、如果只支持ie8+，建议使用<code>*{box-sizing:border-box;}</code>,这个尤其是在移动端，方便百分比的计算</p>
<p>2、单元计算属性<code>calc()</code>，目前兼容性不是很好，不建议使用</p>
<p>3、rem相对与跟元素的单位，一般先设置<code>html{font-size:62.5%}</code>,相当于10px。 然后某个元素需要14px，只需设置1.4rem。不过默认chrome浏览器是不支持12px以下的字体的，所以如果设置的font-size小于1.2rem，那么就相当于是1.2rem，而且除字体外，其余宽度高度的rem计算则以最小为12px为标准计算，如14rem，就不是140px，而是168px</p>
<p>4、Viewport units (vw, vh, vmin, vmax)，兼容性不太好，在不久的将来将会是一大利器</p>
<h2 id="gradient_29"><a href="#gradient_29" class="headerlink" title="gradient)"></a><a href="/(https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Using_CSS_gradients">gradient</a>)</h2><p><a href="http://www.colorzilla.com/gradient-editor/" target="_blank" rel="external">online gradient create</a></p>
<h2 id="u591A_u80CC_u666F_u56FE_u7247"><a href="#u591A_u80CC_u666F_u56FE_u7247" class="headerlink" title="多背景图片"></a><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Using_multiple_backgrounds" target="_blank" rel="external">多背景图片</a></h2><p>1、第一个层级最高，如需要设置背景颜色得在最后一个上面设置</p>
<p>2、background-size设置百分比值的时候，是元素的百分比，而不是背景图片的百分比，而px和em均为背景图片的。</p>
<h2 id="transform"><a href="#transform" class="headerlink" title="transform"></a>transform</h2><p>1、设置transform之后，会影响其子元素的position定位参考</p>
<p>2、transform的skew,rotate,translate,scale设置先后，会影响到其transform-origin的值，如形成正方体有两种办法：第一种先translate到其位置，然后再设置各个旋转；第二种是先在原地旋转好，再设置translate值，代码如下：</p>
<pre><code>.front  { transform: rotateY(   0deg ) translateZ( 100px ); }
.back   { transform: rotateX( 180deg ) translateZ( 100px ); }
.right  { transform: rotateY(  90deg ) translateZ( 100px ); }
.left   { transform: rotateY( -90deg ) translateZ( 100px ); }
.top    { transform: rotateX(  90deg ) translateZ( 100px ); }
.bottom { transform: rotateX( -90deg ) translateZ( 100px ); }
</code></pre><p>3、关于3d transform，设置perspective值可以形成静态的3d视觉效果，而如果需要动态的3d交互效果，则需要再在外包裹一层设置<code>transform-style:preserve-3d</code></p>
<p>4、可使用<code>transform:tranlateZ(0)</code>启动3d加速</p>
<p>5、skew没有3d的，而rotate3d的时候是四个参数（如：<code>transform:rotate3d(3,1,0,10deg)</code>），前三个分别为x、y、z倍率，最后一个为角度基数，旋转的角度为响应的倍率乘以角度基数</p>
<p>6、<a href="http://www.sitepoint.com/advanced-css3-2d-and-3d-transform-techniques/" target="_blank" rel="external">Advanced CSS3 2D and 3D Transform Techniques</a></p>
<p>7、<a href="http://desandro.github.io/3dtransforms/" target="_blank" rel="external">CSS 3D transforms</a></p>
<h2 id="u52A8_u753B"><a href="#u52A8_u753B" class="headerlink" title="动画"></a>动画</h2><p>webkit前缀的浏览器一开始不支持伪元素before和after的动画</p>
<p>关于动画加速，以后将可以使用<a href="https://dev.opera.com/articles/css-will-change-property/" target="_blank" rel="external">will change</a>，现在一般开启3d加速</p>
<h3 id="transition"><a href="#transition" class="headerlink" title="transition"></a><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Using_CSS_transitions" target="_blank" rel="external">transition</a></h3><p>1、以前<code>background</code>是不能作为<code>transition-property</code>的，如果要运动，可以考虑改变background-position的位置</p>
<p>2、关于步骤动画，可以使用<code>transition-timing-function</code>的step函数</p>
<p>3、关于hover动画，定义在选择器中和定义在选择器hover状态时是不同的</p>
<p>4、当元素设置为<code>display:none;</code>时，需要先把元素设置为显示状态，然后在回调函数中使用transition动画。直接从none到显示的时候是会忽略transition动画的。如果使用jquery可以使用animate的属性中设置<code>display:block;</code>回调函数再添加属性变化的class</p>
<pre><code>$(ele).animate({&apos;display&apos;:&apos;block&apos;},300,function(){$(this).addClass(&apos;ele-transition&apos;)})
</code></pre><p>5、<a href="http://blog.alexmaccaw.com/css-transitions" target="_blank" rel="external">All you need to know about CSS Transitions</a></p>
<h3 id="animation"><a href="#animation" class="headerlink" title="animation"></a>animation</h3><p>1、<a href="http://tid.tenpay.com/?p=5983" target="_blank" rel="external">CSS3动画帧数科学计算法</a></p>
<p>2、<a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Using_CSS_animations" target="_blank" rel="external">Using CSS animations</a></p>
<p>3、<a href="http://leaverou.github.io/animatable/" target="_blank" rel="external">animatable</a></p>
<p>3、<code>animation-fill-mode</code>可以设置动画结束在哪个状态</p>
<h2 id="flex"><a href="#flex" class="headerlink" title="flex"></a><a href="http://www.w3cplus.com/blog/666.html" target="_blank" rel="external">flex</a></h2><p>因为flex既可以设置横向布局，也可以设置纵向，所以一般不用x，y轴来标识对齐方式，而是用主轴和次轴</p>
<p>1、uc浏览器的等分会根据本身宽度变化，所以不可靠（如导航的等分，如果每个item都是4个文字，而有一个是6个，那么6个宽度会大点）</p>
<p>2、低端浏览器不支持flex子元素设置width</p>
<p>3、设置flex布局后，如果某个直接子元素设置绝对定位，可能会参与flex的布局</p>
<p>4、第一版本不支持子元素单独设置对齐方式</p>
<p>5、flex布局的性能不是很好</p>
<p>6、flex属性目前三个值兼容性不好</p>
<h2 id="object-fit/object-position"><a href="#object-fit/object-position" class="headerlink" title="object-fit/object-position"></a>object-fit/object-position</h2><ul>
<li><a href="http://www.w3cplus.com/css3/css3-object-fit-and-object-position-properties.html" target="_blank" rel="external">Object-fit/Object-position</a>（中文）</li>
<li><a href="https://docs.webplatform.org/wiki/css/properties/object-fit" target="_blank" rel="external">object-fit/object-position</a></li>
</ul>
<h2 id="mask"><a href="#mask" class="headerlink" title="mask"></a>mask</h2><ul>
<li><a href="http://www.html5rocks.com/en/tutorials/masking/adobe/" target="_blank" rel="external">CSS Masking</a></li>
<li><a href="http://thenittygritty.co/css-masking" target="_blank" rel="external">CSS Masks – How To Use Masking In CSS Now</a></li>
<li><a href="http://ued.ctrip.com/blog/wp-content/webkitcss/index.html" target="_blank" rel="external">mask reference</a></li>
</ul>
<h2 id="multi-column"><a href="#multi-column" class="headerlink" title="multi-column"></a>multi-column</h2><p>这个文本排列使用情况比较少，最简单的就是你得保证能在一屏显示，如果超出一屏，则会影响体验</p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Using_multi-column_layouts" target="_blank" rel="external">Using CSS multi-column layouts</a></p>
<h2 id="media_queries"><a href="#media_queries" class="headerlink" title="media queries"></a>media queries</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Media_queries" target="_blank" rel="external">CSS media queries</a></p>
<p>windows版本的dash<br><a href="https://velocity.silverlakesoftware.com" target="_blank" rel="external">https://velocity.silverlakesoftware.com</a></p>
<p><a href="http://www.cutterman.cn/" target="_blank" rel="external">http://www.cutterman.cn/</a><br><a href="http://css3ps.com/Download/" target="_blank" rel="external">http://css3ps.com/Download/</a></p>
<h3 id="svg"><a href="#svg" class="headerlink" title="svg"></a>svg</h3><p>先通过svg turorial了解下怎么去创建常见的svg图形，然后理解下svg的viewport，再实战于图标，最后制作个svg线性小动画</p>
<ul>
<li><a href="http://tutorials.jenkov.com/svg/rect-element.html" target="_blank" rel="external">SVG Tutorial</a></li>
<li><a href="http://www.zhangxinxu.com/wordpress/2014/08/svg-viewport-viewbox-preserveaspectratio/" target="_blank" rel="external">理解SVG的viewport,viewBox,preserveAspectRatio</a></li>
<li><a href="https://css-tricks.com/svg-symbol-good-choice-icons/" target="_blank" rel="external">SVG <code>symbol</code> a Good Choice for Icons</a></li>
<li><a href="http://isux.tencent.com/16292.html" target="_blank" rel="external">使用SVG中的Symbol元素制作Icon</a></li>
<li><a href="http://jonibologna.com/using-svg-stroke-attributes/" target="_blank" rel="external">Using SVG stroke Attributes</a></li>
<li><a href="https://css-tricks.com/svg-line-animation-works/" target="_blank" rel="external">How SVG Line Animation Works</a></li>
</ul>
<p>更多参考资料：<a href="https://css-tricks.com/mega-list-svg-information/" target="_blank" rel="external">A Compendium of SVG Information</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/11/">&laquo;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/13/">&raquo;</a>
  </nav>

 </div>

        

        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="https://avatars2.githubusercontent.com/u/14305708?v=3&s=460" alt="terry" itemprop="image"/>
          <p class="site-author-name" itemprop="name">terry</p>
        </div>
        <p class="site-description motion-element" itemprop="description">terry yang's blog | java | scala | bi</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">160</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">14</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">53</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="menu-item-icon icon-next-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yangwei8888" target="_blank">github</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/microsoftgoogles" target="_blank">weibo</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/run-zhi-38" target="_blank">zhihu</a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">terry</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    
    

  

    <script type="text/javascript">
      var disqus_shortname = 'yangwei888';
      var disqus_identifier = 'page/12/index.html';
      var disqus_title = '';
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  


  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
